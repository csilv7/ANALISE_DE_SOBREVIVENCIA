[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Análise de Sobrevivência",
    "section": "",
    "text": "Prefácio\nEste é um projeto desenvolvido…",
    "crumbs": [
      "Prefácio"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html",
    "href": "CI_CONC_BASIC.html",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "",
    "text": "1.1 Introdução\nO objetivo deste capítulo inicial é apresentar alguns conceitos e fundamentos de uma das áreas da Estatística e Análise de Dados que mais se desenvolveram nas últimas duas décadas do século XX. Esse avanço foi impulsionado pela evolução das técnicas estatísticas aliada ao progresso computacional.\nNa Análise de Sobrevivência, a variável resposta é, em geral, o tempo até a ocorrência de um evento de interesse. Especificamente, essa área se concentra em modelar e compreender o tempo necessário para que um evento significativo ocorra, sendo este denominado tempo de falha. Como exemplo, Colosimo e Giolo (2006) mencionam casos como o tempo até a morte de um paciente, até a cura de uma doença ou até a recidiva de uma condição clínica.\nUma questão frequentemente levantada é: por que não utilizar outras técnicas estatísticas? Métodos tradicionais não são adequados para dados de sobrevivência devido a uma característica única: a censura. Esse conceito refere-se à observação parcial do tempo de falha, como ocorre quando o acompanhamento de um paciente é interrompido antes do evento de interesse. A censura, sendo um elemento essencial da Análise de Sobrevivência, caracteriza situações em que o tempo de falha real é desconhecido, sabendo-se apenas que ele excede determinado ponto.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#tempo-de-falha",
    "href": "CI_CONC_BASIC.html#tempo-de-falha",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.2 Tempo de Falha",
    "text": "1.2 Tempo de Falha\nNa Análise de Sobrevivência, é fundamental estabelecer alguns pontos iniciais para o estudo. O primeiro deles é o tempo inicial do estudo, que deve ser claramente definido para garantir que os indivíduos sejam comparáveis no ponto de partida, diferenciando-se apenas pelas covariáveis medidas. Existem diversas maneiras de definir o tempo inicial, sendo o mais comum o tempo cronológico. Contudo, em áreas como Engenharia, outras métricas, como número de ciclos ou quilometragem, também podem ser utilizadas. Colosimo e Giolo (2006) apresentam exemplos práticos, como medidas de carga para equipamentos.\nOutro aspecto essencial é a definição do evento de interesse, frequentemente associado a falhas ou situações indesejáveis. Para garantir resultados consistentes, a definição do evento deve ser clara e objetiva. Um exemplo elucidativo é fornecido por Colosimo e Giolo (2006):\n\n“Em algumas situações, a definição de falha já é clara, como morte ou recidiva, mas em outras pode assumir termos ambíguos. Por exemplo, fabricantes de produtos alimentícios desejam saber o tempo de vida de seus produtos expostos em balcões frigoríficos de supermercados. O tempo de falha vai do momento de exposição (chegada ao supermercado) até o produto se tornar ‘inapropriado para consumo’. Esse evento deve ser claramente definido antes do início do estudo. Por exemplo, o produto é considerado inapropriado para consumo quando atinge uma concentração específica de microrganismos por \\(mm^{2}\\) de área.”",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#censura",
    "href": "CI_CONC_BASIC.html#censura",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.3 Censura",
    "text": "1.3 Censura\nEstudos clínicos que tratam a resposta como uma variável temporal geralmente são prospectivos e de longa duração. No entanto, mesmo sendo extensos, esses estudos frequentemente se encerram antes que todos os indivíduos passem pelo evento de interesse.\nUma característica comum nesses estudos é a censura, que corresponde a observações incompletas ou parciais. Apesar disso, tais observações fornecem informações valiosas para a análise. Colosimo e Giolo (2006) destacam a relevância de incluir dados censurados na análise:\n\n“Ressalta-se que, mesmo censurados, todos os resultados provenientes de um estudo de sobrevivência devem ser incluídos na análise estatística. Duas razões justificam esse procedimento: (i) mesmo sendo incompletas, as observações censuradas fornecem informações sobre o tempo de vida dos pacientes; (ii) a exclusão das censuras no cálculo das estatísticas pode levar a conclusões enviesadas.”\n\nExistem três tipos principais de censura:\n\nCensura Tipo I: O estudo é encerrado após um período de tempo previamente definido.\nCensura Tipo II: O estudo termina quando um número específico de indivíduos passa pelo evento de interesse.\nCensura Aleatória: Ocorre quando um indivíduo é retirado do estudo antes do evento de interesse.\n\nA censura mais comum é a censura à direita, em que o evento ocorre após o tempo registrado. Entretanto, outros tipos de censura, como à esquerda e intervalar, também são possíveis.\nCensura à esquerda ocorre quando o evento já aconteceu antes do início da observação. Um exemplo é um estudo sobre a idade em que crianças aprendem a ler:\n\n“Quando os pesquisadores começaram a pesquisa, algumas crianças já sabiam ler e não se lembravam com que idade isso ocorreu, caracterizando observações censuradas à esquerda.”\n\nNo mesmo estudo, observa-se censura à direita para crianças que ainda não sabiam ler no momento da coleta de dados. Nesse caso, os tempos de vida são classificados como duplamente censurados (Turnbull 1974).\nA censura intervalar ocorre em estudos com visitas periódicas espaçadas, onde só se sabe que o evento ocorreu dentro de um intervalo de tempo. Quando o tempo de falha \\(T\\) é impreciso, considera-se que ele pertence a um intervalo \\(T \\in (L, U]\\), conhecido como sobrevivência intervalar. Casos especiais incluem tempos de falha exatos, em que \\(L = U\\), sendo \\(U = 0\\) para censura à direita e \\(L = 0\\) para censura à esquerda (Lindsey e Ryan 1998). Destaca-se a seguinte observação de Colosimo e Giolo (2006):\n\n“A presença de censura traz desafios para a análise estatística. A censura do Tipo II é, em princípio, mais tratável que os outros tipos, mas para situações simples, que raramente ocorrem em estudos clínicos (Lawless 1982). Na prática, utiliza-se resultados assintóticos para a análise dos dados de sobrevivência.”",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#dados-truncados",
    "href": "CI_CONC_BASIC.html#dados-truncados",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.4 Dados Truncados",
    "text": "1.4 Dados Truncados\nO truncamento é uma característica de alguns estudos de sobrevivência que, muitas vezes, é confundida com a censura. Ele ocorre quando certos indivíduos são excluídos do estudo devido a uma condição específica. Nesse caso, os pacientes só são incluídos no acompanhamento após passarem por um determinado evento, em vez de serem acompanhados desde o início do processo.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#sec-ReprDados",
    "href": "CI_CONC_BASIC.html#sec-ReprDados",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.5 Representação dos Dados de Sobrevivência",
    "text": "1.5 Representação dos Dados de Sobrevivência\nConsidere uma amostra aleatória de tamanho \\(n\\). O \\(i\\)-ésimo indivíduo no estudo é geralmente representado pelo par \\((t_{i}, \\delta_{i})\\), onde \\(t_{i}\\) é o tempo de falha ou censura, indicado pela variável binária \\(\\delta_{i}\\), definida como:\n\\[\n\\delta_{i} = \\begin{cases}\n1, & \\text{se } t_{i} \\text{ é um tempo de falha} \\\\\n0, & \\text{se } t_{i} \\text{ é um tempo de censura}.\n\\end{cases}\n\\]\nPortanto, a variável resposta na análise de sobrevivência é representada por duas colunas no conjunto de dados.\nSe o estudo também incluir covariáveis, os dados são representados por \\((t_{i}, \\delta_{i}, \\mathbf{x}i)\\). Caso a censura seja intervalar, a representação é \\((l{i}, u_{i}, \\delta_{i}, \\mathbf{x}_i)\\).\nPara exemplos de dados de sobrevivência, veja a Seção 1.5 do livro de Colosimo e Giolo (2006).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#especificando-o-tempo-de-sobrevivência",
    "href": "CI_CONC_BASIC.html#especificando-o-tempo-de-sobrevivência",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.6 Especificando o Tempo de Sobrevivência",
    "text": "1.6 Especificando o Tempo de Sobrevivência\nSeja \\(T\\) uma variável aleatória (v.a.), na maioria dos casos contínua, que representa o tempo de falha. Assim, o suporte de \\(T\\) é definido nos reais positivos \\(\\mathbb{R}^{+}\\). Tal variável é geralmente representada pela sua função risco ou pela função de taxa de falha (ou taxa de risco). Tais funções, e outras relacionadas, são usadas ao longo do processo de análise de dados de sobrevivência. A seguir, algumas dessas funções e as relações entre elas serão definidas.\n\n1.6.1 Função de Sobrevivência\nEsta é uma das principais funções probabilísticas usadas em análise de sobrevivência. A função sobrevivência é definida como a probabilidade de uma observação não falhar até certo ponto \\(t\\), ou seja a probabilidade de uma observação sobreviver ao tempo \\(t\\). Em probabilidade, isso pode ser escrito como:\n\\[\nS(t) = P(T &gt; t),\n\\tag{1.1}\\]\numa conclusão a qual podemos chegar, é que a probabilidade de uma observação não sobreviver até o tempo \\(t\\), é a acumulada até o ponto \\(t\\), logo,\n\\[\nF(t) = 1 - S(t).\n\\tag{1.2}\\]\n\n\n1.6.2 Função de Taxa de Falha ou de Risco\nA probabilidade da falha ocorrer em um intervalo de tempo \\([t_{1}, t_{2})\\) pode ser expressa em termos da função de sobrevivência como: \\[S(t_{1}) - S(t_{2}).\\]\nA taxa de falha no intervalo \\([t_{1}, t_{2})\\) é definida como a probabilidade de que a falha ocorra neste intervalo, dado que não ocorreu antes de \\(t_{1}\\), dividida pelo comprimento do intervalo. Assim, a taxa de falha no intervalo \\([t_{1}, t_{2})\\) é expressa por \\[\\dfrac{S(t_{1}) - S(t_{2})}{(t_{2} - t_{1})S(t_{1})}.\\]\nDe forma geral, redefinindo o intervalo como \\([t, t + \\Delta t)\\) a expressão assume a seguinte forma:\n\\[\n\\lambda(t) = \\dfrac{S(t) - S(t + \\Delta_{t})}{\\Delta t \\text{ } S(t)}\n\\]\nAssumindo \\(\\Delta t\\) bem pequeno, \\(\\lambda(t)\\) representa a taxa de falha instantânea no tempo \\(t\\) condicional à sobrevivência até o tempo \\(t\\). Observe que as taxas de falha são números positivos, mas sem limite superior. A função de taxa de falha \\(\\lambda(t)\\) é bastante útil para descrever a distribuição do tempo de vida de pacientes. Ela descreve a forma em que a taxa instantânea de falha muda com o tempo. A função de taxa de falha de \\(T\\) é, então, definida como:\n\\[\n\\lambda(t) = \\lim_{\\Delta t \\to 0} \\dfrac{P(t \\leq T \\leq t + \\Delta t | T \\geq t)}{\\Delta t}\n\\tag{1.3}\\]\nA função de taxa de falha é mais informativa do que a função de sobrevivência. Diferentes funções de sobrevivência podem ter formas semelhantes, enquanto as respectivas funções de taxa de falha podem diferir drasticamente. Desta forma, a modelagem da função de taxa de falha é um importante método para dados de sobrevivência.\n\n\n1.6.3 Função de Taxa de Falha Acumulada\nOutra função útil em análise de dados de sobrevivência é a função taxa de falha acumulada. Esta função, como o próprio nome sugere, fornece a taxa de falha acumulada do indivíduo e é definida por:\n\\[\n\\Lambda(t) = \\int_{0}^{t} \\lambda(u) du.\n\\tag{1.4}\\]\nA função de taxa de falha acumulada, \\(\\Lambda(t)\\), não têm uma interpretação direta, mas pode ser útil na avaliação da função de maior interesse que é a função de taxa de falha, \\(\\lambda(t)\\). Isto acontece essencialmente na estimação não-paramétrica em que \\(\\Lambda(t)\\) apresenta um estimador com propriedades ótimas e \\(\\lambda(t)\\) é difícil de ser estimada.\n\n\n1.6.4 Tempo Médio e Vida Média Residual\nOutras duas quantidades de interesse em análise de sobrevivência são: o tempo médio de via e a vida média residual. A primeira é obtida pela área sob a função de sobrevivência. Isto é,\n\\[\nt_{m} = \\int_{0}^{\\infty} S(t) dt.\n\\tag{1.5}\\]\nJá a vida média residual é definida condicional a um certo tempo de vida \\(t\\). Ou seja, para indivíduos com idade \\(t\\) está quantidade mede o tempo médio restante de vida e é, então, a área sob a curva de sobrevivência à direita do tempo \\(t\\) dividida por \\(S(t)\\). Isto é,\n\\[\n\\text{vmr}(t) = \\dfrac{\\int_{0}^{\\infty} (u - t) f(u) du}{S(t)} = \\dfrac{\\int_{0}^{\\infty} S(u) du}{S(t)},\n\\tag{1.6}\\]\nsendo \\(f(\\cdot)\\) a função densidade de \\(T\\). Observe que \\(\\text{vmr}(0) = t_{m}\\).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_CONC_BASIC.html#relações-entre-as-funções",
    "href": "CI_CONC_BASIC.html#relações-entre-as-funções",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.7 Relações entre as Funções",
    "text": "1.7 Relações entre as Funções\nPara \\(T\\) uma variável aleatória contínua e não-negativa, tem-se, em termos das funções definidas anteriormente, algumas relações matemáticas importantes entre elas, a saber:\n\\[\n\\lambda(t) = \\dfrac{f(t)}{S(t)} = - \\dfrac{d}{dt} \\left[ \\log S(t) \\right],\n\\]\n\\[\n\\Lambda(t) = \\int_0^{t} \\lambda(u) du = - \\log S(t)\n\\]\ne\n\\[\nS(t) = \\exp \\left\\{ - \\Lambda(t) \\right\\} = \\exp \\left\\{ - \\int_0^{t} \\lambda(u) du \\right\\}\n\\]\nTais relações mostram que o conhecimento de uma das funções, por exemplo \\(S(t)\\), implica no conhecimento das demais, isto é, \\(F(t)\\), \\(f(t)\\), \\(\\lambda(t)\\) e \\(\\Lambda(t)\\). Outras relações envolvendo estas funções são as seguintes:\n\\[\nS(t) = \\dfrac{\\text{vmr}(0)}{\\text{vmr}(t)} \\exp \\left\\{ - \\int_{0}^{t} \\dfrac{du}{\\text{vmr}(u)} \\right\\}\n\\]\ne\n\\[\n\\lambda(t) = \\left( \\dfrac{d \\text{ } [\\text{vmr}(t)]}{dt} + 1 \\right) / \\text{vmr}(t).\n\\]\n\n\n\n\n\n\n\n\n\n\n\nColosimo, Enrico Antonio, e Suely Ruiz Giolo. 2006. Análise de Sobrevivência Aplicada. 1.ª ed. São Paulo, Brasil: Blucher.\n\n\nLawless, J. F. 1982. Statistical Models and Methods for Lifetime Data. Wiley Series em Probability e Statistics. New York: John Wiley & Sons.\n\n\nLindsey, Jane C., e Louise M. Ryan. 1998. «Methods for Interval-Censored Data». Statistics in Medicine 17 (2): 219–38. https://doi.org/10.1002/(SICI)1097-0258(19980130)17:2&lt;219::AID-SIM735&gt;3.0.CO;2-D.\n\n\nTurnbull, Bruce W. 1974. «Nonparametric Estimation of a Survivorship Function with Doubly Censored Data». Journal of the American Statistical Association 69 (345): 169–73. https://doi.org/10.1080/01621459.1974.10480146.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CII_TEC_N_PARAM.html",
    "href": "CII_TEC_N_PARAM.html",
    "title": "2  Técnicas Não Paramétricas",
    "section": "",
    "text": "2.1 Introdução\nEste capítulo apresenta as técnicas não-paramétricas utilizadas para a análise de dados de sobrevivência. Essas técnicas são empregadas quando não se faz suposições sobre a forma específica da distribuição dos tempos de falha, sendo particularmente úteis para dados censurados.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_TEC_N_PARAM.html#o-estimador-de-kaplan-meier",
    "href": "CII_TEC_N_PARAM.html#o-estimador-de-kaplan-meier",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.2 O Estimador de Kaplan-Meier",
    "text": "2.2 O Estimador de Kaplan-Meier\nProposto por Kaplan e Meier (1958). É um estimador não-paramétrico utilizado para estimar a função de sobrevivência, \\(S(t)\\). Tal estimador também é chamado de de . O Estimador de Kaplan-Meier é uma adaptação a \\(S(t)\\) empiríca que, na ausência de censura nos dados, é definida como:\n\\[\n\\hat{S}(t) = \\dfrac{\\text{nº de observações que não falharam até o tempo } t}{\\text{nº total de observações no estudo}}.\n\\]\n\\(\\hat{S}(t)\\) é uma função que tem uma formato gráfico de escada com degraus nos tempos observados de falha de tamanho \\(1/n\\), onde \\(n\\) é o tamanho amostral.\nO processo utilizado até se obter a estimativa de Kaplan-Meier é um processo passo a passo, em que o próximo passo depende do anterior. De forma suscetível, para qualquer \\(t\\), \\(S(t)\\) pode ser escrito em termos de probabilidades condicionais. Suponha que existam \\(n\\) pacientes no estudo e \\(k (\\leq n)\\) falhas distintas nos tempos \\(t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{k}\\). Considerando \\(S(t)\\) uma função discreta com probabilidade maior que zero somente nos tempos de falha \\(t_{j}\\), \\(j = 1, \\cdots, k\\), tem-se que:\n\\[\nS(t_{j}) = (1 - q_{1}) (1 - q_{2}) \\cdots (1 - q_{j}),\n\\tag{2.1}\\]\nem que \\(q_{j}\\) é a probabilidade de um indivíduo morrer no intervalo \\([t_{j-1}, t{j})\\) sabendo que ele não morreu até \\(t_{j-1}\\) e considerando \\(t_{0} = 0\\). Ou seja, pode se escrever \\(q_{j}\\) como:\n\\[\nq_{j} = P(T \\in [t_{j-1}, t{j}) | T \\geq t_{j-1}),\n\\tag{2.2}\\]\npara \\(j = 1, \\cdots, k\\).\nA expressão geral do estimador de Kaplan-Meier pode ser apresentada após estas considerações preliminares, Formalmente, considere:\n\n\\(t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{k}\\), os \\(k\\) tempos distintos e ordenados de falha;\n\\(d_{j}\\) o número de falhas em \\(t_{j}\\), \\(j = 1, \\cdots, k\\);\n\\(n_{j}\\) o número de indivíduos sob risco em \\(t_{j}\\), ou seja, os indivíduos que não falharam e não foram censurados até o instante imediatamente anterior a \\(t_{j}\\).\n\nCom isso, pode-se definir o estimador de Kaplan-Meier como:\n\\[\n\\hat{S}_{KM}(t) = \\prod_{j \\text{ : } t_{j} &lt; t} \\left( \\dfrac{n_{j} - d_{j}}{n_{j}} \\right) = \\prod_{j \\text{ : } t_{j} &lt; t} \\left( 1 - \\dfrac{d_{j}}{n_{j}} \\right)\n\\tag{2.3}\\]\nDe forma intuitiva, por assim dizer, a Equação 2.3 é proveniente da Equação 2.1, sendo está, uma decomposição de \\(S(t)\\) em termos \\(q_{j}\\)’s. Assim, a Equação 2.3 é justificada se os \\(q_{j}\\)’s forem estimados por \\(d_{j}/n_{j}\\), que em palavras está expresso na Equação 2.2. No artigo original de 1958, Kaplan e Meier provam que a Equação 2.3 é um Estimador de Máxima Verossimilhança (EMV) para \\(S(t)\\). Seguindo certos passos, é possível provar que que \\(\\hat{S}_{KM}(t)\\) é EMV de \\(S(t)\\). Supondo que \\(d_{j}\\) observações falham no tempo tempo \\(t_{j}\\), para \\(j = 1, \\cdots, k\\), e \\(m_{j}\\) observações são censuradas no intervalo \\([t{j}, t_{j+1})\\), nos tempos \\(t_{j1}, \\cdots, t_{jm_{j}}\\). A probabilidade de falha no tempo \\(t_{j}\\) é, então,\n\\[\nS(t_{j}) - S(t_{j}+),\n\\]\ncom \\(S(t_{j}+) = \\lim_{\\Delta t \\to 0+} S(t_{j} + \\Delta t)\\), \\(j = 1, \\cdots, k\\). Por outro lado, a contribuição para a função de verossimilhança de um tempo de sobrevivência censurado em \\(t_{jl}\\) para \\(l = 1, \\cdots, m_{j}\\), é:\n\\[\nP(T &gt; t_{jl}) = S(t_{jl}+).\n\\]\nA função de verossimilhança pode, então, ser escrita como:\n\\[L(S(\\cdot)) = \\prod_{j = 0}^{k} \\left\\{ [ S(t_{j}) - S(t_{j}+) ]^{d_{j}} \\prod_{l = 1}^{m_{j}} S(t_{jl}+) \\right\\}.\\]\nCom isso, é possível provar que \\(S(t)\\) que maximiza \\(L(S(\\cdot))\\) é exatamente a expressão dada pela Equação 2.3.\n\n2.2.1 Propriedades do Estimador de Kaplan-Meier\nComo um estimador de máxima verossimilhança, o estimador de Kaplan-Meier têm interessantes propriedades. As principais são:\n\nÉ não-viciado para grandes amostras;\nÉ fracamente consistente;\nConverge assintoticamente para um processo gaussiano.\n\nA consistência e normalidade assintótica de \\(\\hat{S}_{KM}(t)\\) foram provadas sob certas condições de regularidade, por Breslow e Crowley (1974) e Meier (1975) e, no artigo original, Kaplan e Meier (1958) mostram que \\(\\hat{S}_{KM}(t)\\) é um EMV para \\(S(t)\\), como já dito.\n\n\n2.2.2 Variância do Estimador de Kaplan-Meier\nPara que se possa construir intervalos de confiança e testar hipóteses para \\(S(t)\\), se faz necessário ter conhecimento quanto variabilidade e precisão do estimador de Kaplan-Meier. Este estimador, assim como outros, está sujeito a variações que devem ser descritas em termos de estimações intervalares. A expressão assintótica do estimador de Kaplan-Meier é dada pela Equação 2.4.\n\\[\n\\hat{Var}[\\hat{S}_{KM}(t)] = [\\hat{S}_{KM}(t)]^{2} \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})}\n\\tag{2.4}\\]\nA expressão dada na Equação 2.4, é conhecida como fórmula de Greenwood e pode ser obtida a partir de propriedades do estimador de máxima verossimilhança. Os detalhes da obtenção da Equação 2.4 estão disponíveis em Kalbfleisch e Prentice (1980).\nComo \\(\\hat{S}_{KM}(t)\\), para um \\(t\\) fixo, tem distribuição assintóticamente Normal. O intervalo de confiança com \\(100(1 - \\alpha)\\)% de confiança para \\(\\hat{S}_{KM}(t)\\) é expresso por:\n\\[\n\\hat{S}_{KM}(t) \\pm z_{\\alpha/2} \\sqrt{\\hat{Var}[\\hat{S}_{KM}(t)]}.\n\\]\nVale salientar que para valores extremos de \\(t\\), este intervalo de confiança pode apresentar limites que não condizem com a teoria de probabilidades. Para solucionar tal problema, aplica-se uma transformação em \\(S(t)\\) como, por exemplo, \\(\\hat{U}(t) = \\log{[-\\log{(\\hat{S}_{KM}(t)})]}\\). Esta transformação foi sugerida por Kalbfleisch e Prentice (1980), tendo sua variância estimada por:\n\\[\n\\hat{Var}[\\hat{U}(t)] = \\dfrac{ \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})} }{ \\left[\\sum_{j \\text{ : } t_{j} &lt; t} \\log{\\left( \\dfrac{n_{j} - d_{j}}{n_{j}} \\right)}\\right]^{2}} = \\dfrac{ \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})} }{ \\left[ \\log{\\hat{S}_{KM}(t)} \\right]^{2} }\n\\]\nLogo, pode-se aproximar um intervalo com \\(100 (1 - \\alpha)\\%\\) de confiança para \\(S(t)\\) desta forma:\n\\[\n\\left[ \\hat{S}(t) \\right]^{ \\exp\\left\\{ \\pm z_{\\alpha / 2} \\sqrt{\\hat{Var}[\\hat{U}(t)]} \\right\\}}.\n\\]\nVeja uma aplicação do Estimador de Kaplan-Meier. Os dados de Leucemia Pediátrica dispostos no Apêndice (A) do livro Análise de Sobrevivência Aplicada de Colosimo e Giolo (2006). De posse do conjunto de dados, pode-se estimar a curva de sobrevivência, tal curva foi ilustrada na Figura 2.1.\n\n\nCódigo\n# -----------------------\n# [1] ATIVAÇÃO DE PACOTES\n# -----------------------\nlibrary(survival)\nlibrary(ggplot2)\n\n# ---------------------------------\n# [2] IMPORTAÇÃO E AJUSTE DOS DADOS\n# ---------------------------------\n\n# Caminho URL para os dados\nurl &lt;- \"https://docs.ufpr.br/~giolo/asa/dados/leucemia.txt\"\n\n# Leitura dos dados\ndados &lt;- read.table(url, header = TRUE)\n\n# -----------------------------\n# [3] ESTIMADOR DE KAPLAN-MEIER\n# -----------------------------\nekm &lt;- survfit(Surv(tempos, cens) ~ 1, data = dados)\n\n# -----------------\n# [4] VISUALIZAÇÃO\n# -----------------\n\n# Preparando os dados para o ggplot2\nekm_data &lt;- data.frame(time = ekm$time, survival = ekm$surv,\n  lower = ekm$lower, upper = ekm$upper)\n\n# Gráfico com ggplot2\nggplot(ekm_data, aes(x = time, y = survival)) +\n  geom_line(color = \"blue\", lwd = 1.2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.2) +\n  labs(x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14)\n\n\n\n\n\nFigura 2.1: Curva de Sobrevivência de Kaplan-Meier com IC de 95%",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_TEC_N_PARAM.html#outros-estimadores-não-parâmetricos",
    "href": "CII_TEC_N_PARAM.html#outros-estimadores-não-parâmetricos",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.3 Outros Estimadores Não Parâmetricos",
    "text": "2.3 Outros Estimadores Não Parâmetricos\nO estimador de Kaplan-Meier é, indiscutivelmente, o mais utilizado para estimar \\(S(t)\\) em análises de sobrevivência. Ele é amplamente disponibilizado em diversos pacotes estatísticos e abordado em inúmeros textos de estatística básica. Entretanto, outros dois estimadores de \\(S(t)\\) também possuem relevância significativa na literatura especializada: o estimador de Nelson-Aalen e o estimador da tabela de vida.\nO estimador de Nelson-Aalen, mais recente que o de Kaplan-Meier, apresenta propriedades similares às deste último. Já o estimador da tabela de vida possui importância histórica, tendo sido utilizado em informações derivadas de censos demográficos para estimar características associadas ao tempo de vida humano. Este estimador foi inicialmente proposto por demógrafos e atuários no final do século XIX, sendo empregado principalmente em grandes amostras.\nNesta seção será abordado apenas o estimador de Nelson-Aalen. Para conhecer mais sobre o estimador da Tabela de Vida ou Tabela Atuarial, consulte a Seção 2.4.2 do livro Análise de Sobrevivência Aplicada de Colosimo e Giolo (2006).\n\n2.3.1 Estimador de Nelson-Aalen\nMais recente que o estimador de Kaplan-Meier, este estimador se baseia na função de sobrevivência expressa da seguinte forma:\n\\[\nS(t) = \\exp\\left\\{ - \\Lambda(t) \\right\\},\n\\]\nem que \\(\\Lambda(t)\\) é a função de risco acumulado apresentada na Seção 1.6.3.\nA estimativa para \\(\\Lambda(t)\\) foi inicialmente proposta por Nelson (1972) posteriormente retomada por Aalen (1978) que demonstrou suas propriedades assintóticas utilizando processos de contagem. Na literatura, esse estimador é amplamente conhecido como o estimador de Nelson-Aalen e é definido pela seguinte expressão:\n\\[\n\\hat{\\Lambda}(t) = \\sum_{j:t_{j} &lt; t} \\left( \\dfrac{d_{j}}{n_{j}} \\right),\n\\tag{2.5}\\]\nonde \\(d_{j}\\) e \\(n_{j}\\) são as mesmas definições usadas no estimador de Kaplan-Meier. A variância do estimador, conforme proposta por Aalen (1978), é dada por:\n\\[\n\\hat{Var}(\\hat{\\Lambda}(t)) = \\sum_{j:t_{j} &lt; t} \\left( \\dfrac{d_{j}}{n_{j}^{2}} \\right).\n\\tag{2.6}\\]\nUma alternativa para a estimativa da variância de \\(\\hat{\\Lambda}(t)\\), proposta por Klein (1991), é:\n\\[\n\\hat{Var}(\\hat{\\Lambda}(t)) = \\sum_{j:t_{j} &lt; t} \\dfrac{(n_{j} - d_{j})d_{j}}{n_{j}^{3}},\n\\]\nentretanto, o estimador da Equação 2.6 apresenta menor vício, tornando-o mais preferível que o proposto por Klein (1991).\nDesta forma, podemos definir, com base no estimador de Nelson-Aalen, um estimador para a função de sobrevivência, podendo ser expressa por:\n\\[\n\\hat{S}_{NA}(t) = \\exp\\left\\{- \\hat{\\Lambda}(t) \\right\\}.\n\\]\nDeve-se, a variância deste estimador, a Aalen e Johansen (1978). Podendo ser mensurada pela expressão:\n\\[\n\\hat{Var}(\\hat{S}_{NA}(t)) = \\left[ \\hat{S}_{NA}(t) \\right]^{2} \\sum_{j:t_{j} &lt; t} \\left( \\dfrac{d_{j}}{n_{j}^{2}} \\right)\n\\]\nVale destacar que o estimador de Nelson-Aalen aprenseta, na maioria dos casos, estimativas próximas ao estimador de Kaplan-Meier. Bohoris (1994) mostrou que \\(\\hat{S}_{NA}(t) \\geq \\hat{S}_{KM}(t)\\) para todo \\(t\\), isto é, as estimativas obtidas pelo estimador de Nelson-Aalen são maiores ou iguais às estimativas obtidas pelo estimador de Kaplan-Meier.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_TEC_N_PARAM.html#comparação-de-curvas-de-sobrevivência",
    "href": "CII_TEC_N_PARAM.html#comparação-de-curvas-de-sobrevivência",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.4 Comparação de Curvas de Sobrevivência",
    "text": "2.4 Comparação de Curvas de Sobrevivência\nConsidere um problema na área da saúde em que se deseja comparar dois grupos: um que receberá tratamento com uma determinada droga e outro que será o grupo controle. Estatísticas amplamente utilizadas para esse fim podem ser vistas como generalizações, para dados censurados, de testes não paramétricos bem conhecidos. Entre esses, o teste logrank (Mantel 1966) é o mais empregado em análises de sobrevivência. Gehan (1965) propôs uma generalização para a estatística de Wilcoxon. Outras generalizações foram introduzidas por autores como Peto e Peto (1972) e Prentice (1978), enquanto Latta (1981) utilizou simulações de Monte Carlo para comparar diversos testes não-paramétricos.\nNesta seção, será dada ênfase ao teste logrank, amplamente utilizado em análises de sobrevivência e particularmente adequado quando a razão entre as funções de risco dos grupos a serem comparados é aproximadamente constante. Ou seja, quando as populações apresentam a propriedade de riscos proporcionais.\nA estatística do teste logrank baseia-se na diferença entre o número observado de falhas em cada grupo e o número esperado de falhas sob a hipótese nula. Essa abordagem é semelhante à do teste de Mantel e Haenszel (1959), que combina tabelas de contingência. Além disso, o teste logrank possui a mesma expressão do teste de escore para o modelo de regressão de Cox, que será apresentado no […]. Outros testes também serão discutidos nesta seção.\nConsidere, inicialmente, o teste de igualdade entre duas funções de sobrevivência \\(S_{1}(t)\\) e \\(S_{2}(t)\\). Seja \\(t_{1} &lt; t_{2} &lt; \\ldots &lt; t_{k}\\) a sequência dos tempos de falha distintos observados na amostra combinada, formada pela união das duas amostras individuais. Suponha que, no tempo \\(t_{j}\\), ocorram \\(d_{j}\\) falhas e que \\(n_{j}\\) indivíduos estejam sob risco imediatamente antes de \\(t_{j}\\) na amostra combinada. Nas amostras individuais, as quantidades correspondentes são \\(d_{ij}\\) e \\(n_{ij}\\), onde \\(i = 1, 2\\) representa o grupo e \\(j = 1, \\cdots, k\\) indica o tempo de falha.\nNo tempo \\(t_{j}\\), os dados podem ser organizados em uma tabela de contingência \\(2 \\times 2\\), onde \\(d_{ij}\\) representa o número de falhas e \\(n_{ij} - d_{ij}\\) o número de sobreviventes em cada grupo \\(i\\). Essa disposição está ilustrada na Tabela 2.1.\n\n\n\n\nTabela 2.1: Tabela de contingência gerada no tempo \\(t_{j}\\).\n\n\n\n\n\n\n\nGrupo 1\nGrupo 2\n\n\n\n\n\nFalha\n\\(d_{1j}\\)\n\\(d_{2j}\\)\n\\(d_{j}\\)\n\n\nNão Falha\n\\(n_{1j} - d_{1j}\\)\n\\(n_{2j} - d_{2j}\\)\n\\(n_{j} - d_{j}\\)\n\n\n\n\\(n_{1j}\\)\n\\(n_{2j}\\)\n\\(n_{j}\\)\n\n\n\n\n\n\n\n\nCondicionado à ocorrência de falhas e censuras até o tempo \\(t_{j}\\) (fixando as marginais das colunas) e ao número total de falhas no tempo \\(t_{j}\\) (fixando as marginais das linhas), a distribuição de \\(d_{2j}\\) é, então, uma hipergeométrica:\n\\[\n\\dfrac{ \\binom{ n_{1j} }{ d_{1j} } \\binom{ n_{2j} }{ d_{2j} } }{ \\binom{ n_{j} }{ d_{j} } }.\n\\]\nA média de \\(d_{2j}\\) é dada por \\(w_{2j} = n_{2j} d_{j} n_{j}^{-1}\\). Isso significa que, na ausência de diferenças entre as duas populações no tempo \\(t_{j}\\), o número total de falhas (\\(d_{j}\\)) pode ser alocado entre as duas amostras proporcionalmente à razão entre o número de indivíduos sob risco em cada amostra e o número total sob risco.\nA variância de \\(d_{2j}\\) obtida a partir da distribuição hipergeométrica é:\n\\[\n(V_{j})_{2} = n_{2j}(n_{j} - n_{2j})d_{j}(n_{j} - d_{j}) n_{j}^{-2} (n_{j} - 1)^{-1}.\n\\]\nPortanto, a estatística \\(d_{2j} - w_{2j}\\) possui média zero e variância \\((V_{j})_{2}\\). Se as \\(k\\) tabelas de contingência forem independentes, um teste aproximado para avaliar a igualdade entre as duas funções de sobrevivência pode ser construído com base na seguinte estatística:\n\\[\nT = \\dfrac{ \\left[ \\sum_{j = 1}^{k} (d_{2j} - w_{2j}) \\right]^{2} }{ \\sum_{j = 1}^{k} (V_{j})_{2} },\n\\tag{2.7}\\]\nque, sob a hipótese nula \\(H_{0}: S_{1}(t) = S_{2}(t)\\) para todo \\(t\\) no período de acompanhamento, segue aproximadamente uma distribuição qui-quadrado com \\(1\\) grau de liberdade para amostras grandes.\nPara exemplificar a aplicação do teste de logrank em dados reais, utilizou-se o conjunto de dados sobre Leucemia Pediátrica, disponível no Apêndice (A) do livro Análise de Sobrevivência Aplicada de Colosimo e Giolo (2006). Esses mesmos dados foram usados para gerar a Figura 2.1. O objetivo do teste realizado foi avaliar se as curvas de sobrevivência das categorias da covariável r6 são iguais, com as seguintes hipóteses:\n\\[\n\\begin{cases}\n  H_{0}: \\text{As curvas de sobrevivência dos grupos são iguais ao longo do tempo} \\\\\n  H_{1}: \\text{As curvas de sobrevivência dos grupos são diferentes ao longo do tempo.}\n\\end{cases}\n\\]\nVeja a saída resultante do teste realizado no software R:\n\n\nCódigo\n# -----------------------\n# [1] ATIVAÇÃO DE PACOTES\n# -----------------------\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# ----------------------------------\n# [2] IMPORTAÇÃO E AJUSTES DOS DADOS\n# ----------------------------------\n\n# Caminho URL para os dados\nurl &lt;- \"https://docs.ufpr.br/~giolo/asa/dados/leucemia.txt\"\n\n# Leitura dos dados\ndf &lt;- read.table(url, header = TRUE)\n\n# Decodificando a coluna r_6\ndf &lt;- df %&gt;%\n  mutate(grupo = ifelse(r6 == 0, \"Category Zero\", \"Category One\"))\n\n# ----------------------\n# [3] TESTE DE LOGRANK\n# ----------------------\n\n# Aplicando o Teste de Logrank\nTestLogrank &lt;- survdiff(Surv(tempos, cens) ~ grupo, data = df, rho = 0)\nprint(TestLogrank)\n\n\nCall:\nsurvdiff(formula = Surv(tempos, cens) ~ grupo, data = df, rho = 0)\n\n                     N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupo=Category One  95       34    37.16     0.269      5.73\ngrupo=Category Zero  8        5     1.84     5.429      5.73\n\n Chisq= 5.7  on 1 degrees of freedom, p= 0.02 \n\n\nAo fixar o nível de significância em 5% (\\(\\alpha = 0,05\\)), rejeitamos a hipótese nula. Essa conclusão baseia-se no valor \\(p\\) (probabilidade de significância) obtido no teste, calculado como \\(p-valor =\\) 0.0166441. Como o \\(p-valor &lt; \\alpha\\), rejeita-se \\(H_{0}\\). Assim, conclui-se que as curvas de sobrevivência dos grupos são diferentes ao longo do tempo, ao nível de significância de 5%.\nA generalização do teste logrank para a comparação de \\(r &gt; 2\\) funções de sobrevivência, \\(S_{1}(t), S_{2}(t), \\ldots, S_{r}(t)\\), é direta. Utilizando a mesma notação anterior, o índice \\(i\\) varia agora de \\(1\\) a \\(r\\). Assim, os dados podem ser organizados em uma tabela de contingência \\(2 \\times r\\), onde cada coluna \\(i\\) contém \\(d_{ij}\\) falhas e \\(n_{ij} - d_{ij}\\) sobreviventes. Dessa forma, a Tabela 2.1 seria estendida para ter \\(r\\) colunas em vez de apenas duas.\nCondicionada à experiência de falha e censura até o tempo \\(t_{j}\\) e ao número total de falhas no tempo \\(t_{j}\\), a distribuição conjunta de \\(d_{2j}, \\ldots,d_{rj}\\) segue uma hipergeométrica multivariada, dada por:\n\\[\n\\dfrac{ \\prod_{i = 1}^{r} \\binom{ n_{ij }}{ d_{ij} } }{ \\binom{ n_{j }}{ d_{j} } }.\n\\]\nA média de \\(d_{ij}\\) é \\(w_{ij} = n_{ij} d_{j} n_{j}^{-1}\\), bem como a variância de \\(d_{ij}\\) e a covariância de \\(d_{ij}\\) e \\(d_{lj}\\) são, respectivamente,\n\\[\n(V_{j})_{ii} = n_{ij} (n_{j} - n_{ij}) d_{j} (n_{j} - d_{j}) n_{j}^{-2} (n_{j} - 1)^{-1}\n\\]\ne\n\\[\n(V_{j})_{il} = - n_{ij} n_{lj} d_{j} (n_{j} - d_{j}) n_{j}^{-2} (n_{j} - 1)^{-1}.\n\\]\nA estatística \\(v'_{j} = (d_{2j} - w_{2j}, \\ldots, d_{rj} - w_{rj})\\) possui média zero e matriz de variância-covariância \\(V_{j}\\), com dimensão \\(r - 1\\). A matriz \\(V_{j}\\) contém os termos \\((V_{j}){ii}\\) na diagonal principal e \\((V_{j})_{il}\\), \\(i,l = 2, \\ldots,r\\), fora da diagonal principal.\nA estatística \\(v\\), que agrega as contribuições de todos os tempos distintos de falha, é definida como:\n\\[\nv = \\sum_{j = 1}^{k} v_{j},\n\\]\nonde \\(v\\) é um vetor de dimensão \\((r - 1) \\times 1\\), cujos elementos correspondem às diferenças entre os totais observados e esperados de falhas.\nConsiderando, novamente, a independência das \\(k\\) tabelas de contingência, a variância de \\(v\\) é dada por \\(V = V_{1} + \\ldots + V_{k}\\). Um teste aproximado para a igualdade das \\(r\\) funções de sobrevivência pode ser baseado na estatística:\n\\[\nT = v´V^{-1} v,\n\\tag{2.8}\\]\nque, sob a hipótese nula \\(H_{0}\\) (igualdade das curvas de sobrevivência), segue uma distribuição qui-quadrado com \\(r - 1\\) graus de liberdade para amostras grandes. Os graus de liberdade são \\(r - 1\\) em vez de \\(r\\), pois os elementos de \\(v\\) somam zero.\nUma aplicação para a comparação de \\(r\\) curvas de sobrevivência […].\n\n\nCódigo\ncat(\"Código em R a ser preenchido\")\n\n\nCódigo em R a ser preenchido\n\n\n\n2.4.1 Outros Testes\n[…]\n\n\n\n\n\n\n\n\n\n\n\nAalen, Odd O. 1978. «Nonparametric Inference for a Family of Counting Processes». Annals of Statistics 6 (4): 701–26. https://doi.org/10.1214/aos/1176344247.\n\n\nAalen, Odd O., e Søren Johansen. 1978. «An Empirical Transition Matrix for Non-Homogeneous Markov Chains Based on Censored Observations». Scandinavian Journal of Statistics 5 (3): 141–50.\n\n\nBohoris, G. A. 1994. «Comparison of the Cumulative-Hazard and Kaplan-Meier Estimators of the Survivor Function». IEEE Transactions on Reliability 43 (2): 230–32. https://doi.org/10.1109/24.293488.\n\n\nBreslow, Norman, e John Crowley. 1974. «A Large Sample Study of the Life Table and Product Limit Estimates under Random Censorship». The Annals of Statistics 2 (3): 437–53. https://doi.org/10.1214/aos/1176342705.\n\n\nColosimo, Enrico Antonio, e Suely Ruiz Giolo. 2006. Análise de Sobrevivência Aplicada. 1.ª ed. São Paulo, Brasil: Blucher.\n\n\nGehan, Edmund A. 1965. «A Generalized Wilcoxon Test for Comparing Arbitrarily Singly-Censored Samples». Biometrika 52 (1-2): 203–24. https://doi.org/10.2307/2333825.\n\n\nKalbfleisch, John D., e Ross L. Prentice. 1980. The Statistical Analysis of Failure Time Data. Wiley Series em Probability e Mathematical Statistics. New York: Wiley.\n\n\nKaplan, Edward L., e Paul Meier. 1958. «Nonparametric Estimation from Incomplete Observations». Journal of the American Statistical Association 53 (282): 457–81. https://doi.org/10.1080/01621459.1958.10501452.\n\n\nKlein, John P. 1991. «Small Sample Moments of Some Estimators of the Variance of the Kaplan-Meier and Nelson-Aalen Estimators». Scandinavian Journal of Statistics 18 (4): 333–40. https://doi.org/10.2307/4616203.\n\n\nLatta, Robert B. 1981. «A Monte Carlo Study of Some Two-Sample Rank Tests with Censored Data». Journal of the American Statistical Association 76 (375): 713–19. https://doi.org/10.2307/2287572.\n\n\nMantel, Nathan. 1966. «Evaluation of Survival Data and Two New Rank Order Statistics Arising in Its Consideration». Cancer Chemotherapy Reports 50 (3): 163–70.\n\n\nMantel, Nathan, e William Haenszel. 1959. «Statistical Aspects of the Analysis of Data from Retrospective Studies of Disease». Journal of the National Cancer Institute 22 (4): 719–48.\n\n\nMeier, Paul. 1975. «Estimation of a Survival Curve from Incomplete Data». Journal of the American Statistical Association 70 (351): 607–10. https://doi.org/10.1080/01621459.1975.10479872.\n\n\nNelson, Wayne. 1972. «Theory and Applications of Hazard Plotting for Censored Failure Data». Technometrics 14 (4): 945–66. https://doi.org/10.1080/00401706.1972.10488981.\n\n\nPeto, Richard, e Julian Peto. 1972. «Asymptotically Efficient Rank Invariant Test Procedures». Journal of the Royal Statistical Society: Series A (General) 135 (2): 185–98. https://doi.org/10.2307/2344317.\n\n\nPrentice, Ross L. 1978. «Linear Rank Tests with Right Censored Data». Biometrika 65 (1): 167–79. https://doi.org/10.2307/2335206.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CIV_MTVA.html",
    "href": "CIV_MTVA.html",
    "title": "4  Modelos de Tempo de Vida Acelerado",
    "section": "",
    "text": "4.1 Introdução",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelos de Tempo de Vida Acelerado</span>"
    ]
  },
  {
    "objectID": "CIV_MTVA.html#distribuição-exponencial",
    "href": "CIV_MTVA.html#distribuição-exponencial",
    "title": "4  Modelos de Tempo de Vida Acelerado",
    "section": "4.2 Distribuição Exponencial",
    "text": "4.2 Distribuição Exponencial\nEm modelos de tempo de vida acelerados a distribuição exponencial tem densidade expressa por:\n\\[\nf(t) = \\alpha \\exp\\left\\{ - \\alpha \\left( \\dfrac{t}{\\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} \\right) \\right\\}.\n\\tag{4.1}\\]\nA partir de Equação 4.1 pode-se obter a função de sobrevivência, dada por:\n\\[\nS(t) = \\exp\\left\\{ - \\alpha \\left( \\dfrac{t}{\\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} \\right) \\right\\}.\n\\tag{4.2}\\]\nDesta forma, é possível chegar na função de log-verossimilhança dada pela Equação 4.3 para MTVA da distribuição exponencial.\n\\[\nl(\\theta) = \\ln[\\alpha] \\sum_{i = 1}^{n} \\delta_{i} - \\alpha \\sum_{i = 1}^{n} \\dfrac{t_{i}}{\\exp\\{\\mathbf{x'}_{i}\\boldsymbol{\\beta}\\}},\n\\tag{4.3}\\]\nonde \\(\\theta = (\\alpha, \\beta_{0}, \\beta_{1}, \\ldots, \\beta_{p})\\). Toma-se as derivadas parciais em relação a cada parâmetro deste modelo, desta forma, tem-se:\n\\[\n\\dfrac{\\partial l(\\theta)}{\\partial \\alpha} = \\dfrac{1}{\\alpha} \\sum_{i = 1}^{n} \\delta_{i} - \\sum_{i = 1}^{n} \\dfrac{t_{i}}{\\exp\\{\\mathbf{x'}_{i}\\boldsymbol{\\beta}\\}},\n\\]\npara \\(\\beta_{0}\\), temos:\n\\[\n\\dfrac{\\partial l(\\theta)}{\\partial \\beta_{0}} = \\alpha \\sum_{i = 1}^{n} \\dfrac{t_{i}}{\\exp\\{\\mathbf{x'}_{i}\\boldsymbol{\\beta}\\}}.\n\\]\nPara qualquer outro coeficiente \\(\\beta_{k}\\) para \\(k = 1, 2, \\ldots, p\\), derivando, temos:\n\\[\n\\dfrac{\\partial l(\\theta)}{\\partial \\beta_{k}} = - \\alpha \\sum_{i = 1}^{n} \\frac{\\partial}{\\partial \\beta_{k}} \\left[ \\frac{t_{i}}{\\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} \\right] = - \\alpha \\sum_{i = 1}^{n} - \\frac{t_{i} x_{ki}}{\\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} = \\alpha \\sum_{i = 1}^{n} \\frac{t_{i} x_{ki}}{\\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}}.\n\\] Para obter as estimativas para o vetor de parâmetros \\(\\theta\\) temos que utilizar algum método numérico, pois não a solução análitica para as funções (não lineares) resultantes das derivadas.\nVamos a um exemplo usando dados simulados. Não há função pronta para simular tempos de vida acelerados de uma distribuição específica no R como, por exemplo, rexp, desta forma, adotou-se o método da inversa da distribuição acumalada.\nSabemos, para a distribuição exponencial, que \\(F(t) = 1 - \\exp\\{ -\\alpha t \\}\\), e ainda, \\(F(t) = U\\), onde \\(U \\sim Uniforme(0, 1)\\). Logo, para simularmos uma variável aleatória que siga uma disitribuição exponencial de parâmetro \\(\\alpha\\), temos:\n\\[\nt = F^{-1}(U).\n\\tag{4.4}\\]\nUtilizando desta definição, temos para a distribuição exponencial de tempo de vida acelerado:\n\\[\\begin{align*}\n    F(t)  & = U \\\\\n    1 - \\exp\\{ -\\alpha t \\} & = U \\\\\n    -\\alpha t & = \\ln[ 1 - U ],\n\\end{align*}\\]\nassim,\n\\[\nt = - \\dfrac{ \\ln[ 1 - U ] }{ \\alpha }.\n\\tag{4.5}\\]\n\n\nCódigo\n# -----------------------\n# [1] Ativação de Pacotes\n# -----------------------\n\nlibrary(ggplot2)\nlibrary(survival)\n\n# ----------------------------\n# [2] Distribuição Exponencial\n# ----------------------------\n# ------------------------------\n# [2.2] Simulação de Monte Carlo\n# ------------------------------\n# ---------------------------\n# [2.2.1] Função de Simulação\n# ---------------------------\n\nmyRexp &lt;- function(n, rate, coVariates, vecCoef) {\n  set.seed(123456789)\n  # Uniforme(0, 1)\n  U &lt;- runif(n, 0, 1)\n  \n  # Combinação linear dos preditores lineares\n  effect &lt;- coVariates %*% vecCoef\n  \n  # Tempos de sobrevivência\n  times &lt;- - exp(effect) * log(1 - U) / rate\n  \n  return(times)\n}\n\n# --------------------------\n# [2.2.2] Simulação de Dados\n# --------------------------\n\nset.seed(123456789)\n\n# Tamanho da amostra e número de variáveis\nn &lt;- 1000\np &lt;- 2\n\n# Parâmetro da distribuição exponencial\ntaxa &lt;- 1\n\n# Matriz Design\nx1 &lt;- rnorm(n, 0, 1)\nx2 &lt;- rbinom(n, 1, 0.5)\nX &lt;- matrix(\n  data = c(rep(1, n), x1, x2),\n  nrow = n, ncol = p + 1\n)\n\n# Vetor de Coeficientes Betas\nbetas &lt;- matrix(data = c(3/2, 2/3, 2), nrow = p + 1, ncol = 1)\n\n# Simulando o Tempo de Sobrevivência\ntimesSurv &lt;- myRexp(n, taxa, X, betas)\n\n\nSimulou-se uma amostra de tamanho \\(1000\\) e com duas covariáveis, também simuladas, sendo \\(X_{1} \\sim Normal(0, 1)\\) e \\(X_{2} \\sim Bernoulli(0,5)\\). O vetor de parâmetros utilizado na simulação foi \\(\\theta = (1, \\ 3/2, \\ 2/3, \\ 2)\\). Veja a Figura 4.1, que mostra o histograma e a estimativa de Kaplan-Meier para os dados simulados.\n\nCódigo\n# Histograma\nggplot(data = data.frame(Tempo = timesSurv), aes(x = Tempo)) +\n  geom_histogram(fill = \"blue\") +\n  labs(x = \"Tempo\", y = \"Frequência\") +\n  theme_minimal(base_size = 14)\n\n# Probabilidade de Sobrevivência\ncens &lt;- rep(1, n)\nekm &lt;- survfit(Surv(timesSurv, cens)~1)\nekm_data &lt;- data.frame(\n  time = ekm$time,\n  survival = ekm$surv,\n  lower = ekm$lower,\n  upper = ekm$upper\n)\nggplot(ekm_data, aes(x = time, y = survival)) +\n  geom_step(color = \"blue\", size = 1.2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.2) +\n  labs(x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14)\n\n\n\n\nFigura 4.1: Histogramas e Função de Sobrevivência estimada por Kaplan-Meier para os dados simulados.\n\n\n\n\n\n\n\n\n\n\n(a) Histograma do Tempo de Sobrevida\n\n\n\n\n\n\n\n\n\n\n\n(b) Função de Sobrevivência\n\n\n\n\n\n\n\n\nSeguimos para a etapa de estimação de parâmetros. Será usado mesmo método, Iterativo de Newton-Raphson em diferentes funções. Uma das funções será a survreg do pacote survival e a outra usando optim para maximazação da verossimilhança. Usando a função survreg, obtemos as seguintes estimativas para os coeficientes \\(\\beta\\).\n\n\nCódigo\n# -----------------------------------\n# [3.1] Ajuste pelo Pacote \"Survival\"\n# -----------------------------------\n\nfit1 &lt;- survreg(formula = Surv(timesSurv, cens)~x1 + x2, \n                dist = \"exponential\")\nsummary(fit1)\n\n\n\nCall:\nsurvreg(formula = Surv(timesSurv, cens) ~ x1 + x2, dist = \"exponential\")\n             Value Std. Error    z      p\n(Intercept) 1.5221     0.0456 33.4 &lt;2e-16\nx1          0.6911     0.0310 22.3 &lt;2e-16\nx2          1.9588     0.0635 30.9 &lt;2e-16\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -3545.2   Loglik(intercept only)= -4208.8\n    Chisq= 1327.24 on 2 degrees of freedom, p= 6.2e-289 \nNumber of Newton-Raphson Iterations: 5 \nn= 1000 \n\n\nNota-se que as estimativas obtidas pela função survreg são bem próximas dos verdadeiros parâmetros. Algo já esperado devido o tamanho da amostra simulada. Usando a função optim, obtemos as seguintes estimativas.\n\n\nCódigo\n# --------------------\n# [3.1] Via otimização\n# --------------------\n# ---------------------------\n# [3.1.1] Log-Verossimilhança\n# ---------------------------\n\nlogVerossimil &lt;- function(theta, coVariates, times) {\n  # Comprimento do Vetor de observações\n  n &lt;- length(times)\n  \n  # Comprimento do vetor de parâmetros\n  nPar &lt;- length(theta)\n  \n  # Parâmetro de Taxa e Preditores Lineares\n  rate &lt;- theta[1]\n  betas &lt;- theta[2:nPar]\n  \n\n  # Combinação linear dos preditores lineares\n  effect &lt;- coVariates %*% betas\n  \n  # Função de Log-verossimilhança\n  flv &lt;- n * rate - rate * sum(times / exp(effect))\n  \n  return(-flv)\n}\n\n# --------------------\n# [3.1.1] Função optim\n# --------------------\n\ntheta0 &lt;- rep(1, 4) # Chute inicial\n\n# Aplicação do algoritmo\nestimate &lt;- optim(\n  par = theta0,\n  fn = logVerossimil,\n  method = \"BFGS\",\n  hessian = TRUE,\n  coVariates = X,\n  times = timesSurv\n)\n\n# Resultados\nestimate$par\n\n\n[1]  2.684355e+11  1.967030e+02 -4.108872e-01  1.111092e+02",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelos de Tempo de Vida Acelerado</span>"
    ]
  },
  {
    "objectID": "CIV_MTVA.html#distribuição-weibull",
    "href": "CIV_MTVA.html#distribuição-weibull",
    "title": "4  Modelos de Tempo de Vida Acelerado",
    "section": "4.3 Distribuição Weibull",
    "text": "4.3 Distribuição Weibull\nPara tempos de vida acelerados que seguem distribuição Weibull, temos a seguinte forma para sua densidade:\n\\[\nf(t) = \\dfrac{\\gamma}{\\alpha^{\\gamma}} t^{\\gamma - 1} \\exp\\left\\{ - \\left( \\dfrac{t}{\\alpha \\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} \\right)^{\\gamma} \\right\\}.\n\\tag{4.6}\\]\nE função de sobrevivência expressa por:\n\\[\nS(t) = \\exp\\left\\{ - \\left( \\dfrac{t}{\\alpha \\exp\\{\\mathbf{x'}\\boldsymbol{\\beta}\\}} \\right)^{\\gamma} \\right\\}\n\\tag{4.7}\\]",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelos de Tempo de Vida Acelerado</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referêcias",
    "section": "",
    "text": "Aalen, Odd O. 1978. “Nonparametric Inference for a Family of\nCounting Processes.” Annals of Statistics 6 (4): 701–26.\nhttps://doi.org/10.1214/aos/1176344247.\n\n\nAalen, Odd O., and Søren Johansen. 1978. “An Empirical Transition\nMatrix for Non-Homogeneous Markov Chains Based on Censored\nObservations.” Scandinavian Journal of Statistics 5 (3):\n141–50.\n\n\nBohoris, G. A. 1994. “Comparison of the Cumulative-Hazard and\nKaplan-Meier Estimators of the Survivor Function.” IEEE\nTransactions on Reliability 43 (2): 230–32. https://doi.org/10.1109/24.293488.\n\n\nBreslow, Norman, and John Crowley. 1974. “A Large Sample Study of\nthe Life Table and Product Limit Estimates Under Random\nCensorship.” The Annals of Statistics 2 (3): 437–53. https://doi.org/10.1214/aos/1176342705.\n\n\nBussab, Wilton de Oliveira, and Pedro Alberto Morettin. 2010.\nEstatística Básica. 6ª ed. São Paulo: Saraiva.\n\n\nColosimo, Enrico Antonio, and Suely Ruiz Giolo. 2006. Análise de\nSobrevivência Aplicada. 1st ed. São Paulo, Brasil: Blucher.\n\n\nGehan, Edmund A. 1965. “A Generalized Wilcoxon Test for Comparing\nArbitrarily Singly-Censored Samples.” Biometrika 52\n(1-2): 203–24. https://doi.org/10.2307/2333825.\n\n\nKalbfleisch, John D., and Ross L. Prentice. 1980. The Statistical\nAnalysis of Failure Time Data. Wiley Series in Probability and\nMathematical Statistics. New York: Wiley.\n\n\nKaplan, Edward L., and Paul Meier. 1958. “Nonparametric Estimation\nfrom Incomplete Observations.” Journal of the American\nStatistical Association 53 (282): 457–81. https://doi.org/10.1080/01621459.1958.10501452.\n\n\nKlein, John P. 1991. “Small Sample Moments of Some Estimators of\nthe Variance of the Kaplan-Meier and Nelson-Aalen Estimators.”\nScandinavian Journal of Statistics 18 (4): 333–40. https://doi.org/10.2307/4616203.\n\n\nLatta, Robert B. 1981. “A Monte Carlo Study of Some Two-Sample\nRank Tests with Censored Data.” Journal of the American\nStatistical Association 76 (375): 713–19. https://doi.org/10.2307/2287572.\n\n\nLawless, J. F. 1982. Statistical Models and Methods for Lifetime\nData. Wiley Series in Probability and Statistics. New York: John\nWiley & Sons.\n\n\nLindsey, Jane C., and Louise M. Ryan. 1998. “Methods for\nInterval-Censored Data.” Statistics in Medicine 17 (2):\n219–38. https://doi.org/10.1002/(SICI)1097-0258(19980130)17:2&lt;219::AID-SIM735&gt;3.0.CO;2-D.\n\n\nMantel, Nathan. 1966. “Evaluation of Survival Data and Two New\nRank Order Statistics Arising in Its Consideration.” Cancer\nChemotherapy Reports 50 (3): 163–70.\n\n\nMantel, Nathan, and William Haenszel. 1959. “Statistical Aspects\nof the Analysis of Data from Retrospective Studies of Disease.”\nJournal of the National Cancer Institute 22 (4): 719–48.\n\n\nMeier, Paul. 1975. “Estimation of a Survival Curve from Incomplete\nData.” Journal of the American Statistical Association\n70 (351): 607–10. https://doi.org/10.1080/01621459.1975.10479872.\n\n\nNelson, Wayne. 1972. “Theory and Applications of Hazard Plotting\nfor Censored Failure Data.” Technometrics 14 (4):\n945–66. https://doi.org/10.1080/00401706.1972.10488981.\n\n\nPeto, Richard, and Julian Peto. 1972. “Asymptotically Efficient\nRank Invariant Test Procedures.” Journal of the Royal\nStatistical Society: Series A (General) 135 (2): 185–98. https://doi.org/10.2307/2344317.\n\n\nPrentice, Ross L. 1978. “Linear Rank Tests with Right Censored\nData.” Biometrika 65 (1): 167–79. https://doi.org/10.2307/2335206.\n\n\nTurnbull, Bruce W. 1974. “Nonparametric Estimation of a\nSurvivorship Function with Doubly Censored Data.” Journal of\nthe American Statistical Association 69 (345): 169–73. https://doi.org/10.1080/01621459.1974.10480146.",
    "crumbs": [
      "Referêcias"
    ]
  }
]