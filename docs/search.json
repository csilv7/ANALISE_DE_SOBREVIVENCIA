[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Análise de Sobrevivência",
    "section": "",
    "text": "Prefácio\nEste é um projeto desenvolvido…",
    "crumbs": [
      "Prefácio"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html",
    "href": "CI_ConceitosBasicos.html",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "",
    "text": "1.1 Introdução\nO primeiro capítulo do livro de Enrico Antônio Colosimo e Suely Ruiz Giolo tem como objetivo apresentar alguns conceitos e fundamentos de uma das áreas da Estatística e Análise de Dados que mais cresceram nas últimas duas décadas do século passado. Esse crescimento foi impulsionado pelo desenvolvimento e avanço de técnicas, juntamente com o progresso computacional.\nNa Análise de Sobrevivência, a variável resposta é, geralmente, o tempo até a ocorrência de um determinado evento. De forma mais precisa, trata-se de uma técnica estatística utilizada para modelar e entender o tempo até que ocorra um evento de interesse, denominado tempo de falha. Para um entendimento inicial, Colosimo e Giolo dão os seguintes exemplos: tempo até a morte de um paciente, tempo até a cura ou até a recidiva de uma doença.\nUma questão que pode surgir é: por que não usar outras técnicas estatísticas? O uso de outras abordagens não é adequado para dados de sobrevivência devido à característica desses dados, que é a presença de censura. De forma simples, censura refere-se à observação parcial da resposta, o que ocorre quando o acompanhamento do paciente é interrompido por alguma razão. Sendo um conceito chave na análise de sobrevivência, podemos defini-la como a situação em que o tempo de falha real não é conhecido, apenas que ele excede certo ponto.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#tempo-de-falha",
    "href": "CI_ConceitosBasicos.html#tempo-de-falha",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.2 Tempo de Falha",
    "text": "1.2 Tempo de Falha\nEm Análise de Sobrevivência, é essencial definir alguns pontos fundamentais para o estudo. O primeiro deles é o tempo de início do estudo, que deve ser definido com precisão, garantindo que os indivíduos sejam comparáveis na origem do estudo, diferenciando-se apenas nas medidas das covariáveis. Existem muitas alternativas para definir o tempo inicial. Geralmente, esse tempo é o tempo real ou “de relógio”. Porém, em outras áreas, como a Engenharia, outras medidas podem ser utilizadas. Colosimo e Giolo fornecem exemplos como número de ciclos, quilometragem de um carro ou qualquer outra medida de carga.\nOutro ponto importante relacionado ao Tempo de Falha é a definição do evento de interesse. Normalmente, esses eventos correspondem a situações indesejáveis, por isso são chamados de falhas. A definição da falha deve ser clara e precisa. Destaca-se um trecho do livro:\n\n“Em algumas situações, a definição de falha já é clara, como morte ou recidiva, mas em outras pode assumir termos ambíguos. Por exemplo, fabricantes de produtos alimentícios desejam saber o tempo de vida de seus produtos expostos em balcões frigoríficos de supermercados. O tempo de falha vai do momento de exposição (chegada ao supermercado) até o produto se tornar ‘inapropriado para consumo’. Esse evento deve ser claramente definido antes do início do estudo. Por exemplo, o produto é considerado inapropriado para consumo quando atinge uma concentração específica de microrganismos por \\(mm^{2}\\) de área.”",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#censura",
    "href": "CI_ConceitosBasicos.html#censura",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.3 Censura",
    "text": "1.3 Censura\nFrequentemente, estudos clínicos que assumem a resposta como uma variável temporal são prospectivos e de longa duração. Mesmo sendo longos, esses estudos costumam terminar antes que todos os indivíduos venham a falhar.\nUma característica comum a esses estudos é a presença de censura, ou seja, observações incompletas ou parciais. É importante ressaltar que, mesmo censuradas, essas observações fornecem informações valiosas sobre o tempo de vida dos pacientes. Colosimo e Giolo destacam a importância de manter os dados censurados na análise:\n\n“Ressalta-se que, mesmo censurados, todos os resultados provenientes de um estudo de sobrevivência devem ser incluídos na análise estatística. Duas razões justificam esse procedimento: (i) mesmo sendo incompletas, as observações censuradas fornecem informações sobre o tempo de vida dos pacientes; (ii) a exclusão das censuras no cálculo das estatísticas pode levar a conclusões enviesadas.”\n\nSão apresentados três tipos principais de censura:\n\nCensura Tipo I: O estudo é encerrado após um período de tempo pré-estabelecido.\nCensura Tipo II: O estudo termina quando o evento de interesse ocorre em um número específico de indivíduos.\nCensura Aleatória: Ocorre quando um paciente é retirado do estudo antes do evento.\n\nNo livro, a Figura 1.1 ilustra esses tipos de censura, todos conhecidos como censura à direita, pois o evento ocorre após o tempo registrado. Contudo, outros tipos de censura, como à esquerda e intervalar, também são possíveis.\nCensura à esquerda ocorre quando o evento já aconteceu antes da observação. Um exemplo do livro é um estudo sobre a idade em que as crianças aprendem a ler em determinada comunidade:\n\n“Quando os pesquisadores começaram a pesquisa, algumas crianças já sabiam ler e não se lembravam com que idade isso ocorreu, caracterizando observações censuradas à esquerda.”\n\nNo mesmo estudo, há censura à direita para crianças que não sabiam ler quando os dados foram coletados. Neste caso, os tempos de vida são considerados duplamente censurados (Turnbull, 1974).\nDe forma geral, a censura intervalar ocorre em estudos com visitas periódicas espaçadas, onde só se sabe que a falha ocorreu dentro de um intervalo de tempo. Quando o tempo de falha \\(T\\) é impreciso, é dito que ele pertence a um intervalo \\(T \\in (L, U]\\). Esses dados são conhecidos como sobrevivência intervalar ou dados de censura intervalar. Note que tempos exatos de falha, sejam censura à direita ou à esquerda, são casos especiais de sobrevivência intervalar com \\(L = U\\). Em particular, \\(U = 0\\) para censura à direita e \\(L = 0\\) para censura à esquerda (Lindsey et al., 1998). veja a nota a seguir, que enfatiza um trecho que merece atenção no livro.\n\nNota: “A presença de censura traz desafios para a análise estatística. A censura do Tipo II é, em princípio, mais tratável que os outros tipos, mas para situações simples, que raramente ocorrem em estudos clínicos (Lawless, 1982). Na prática, utiliza-se resultados assintóticos para a análise dos dados de sobrevivência.”",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#dados-truncados",
    "href": "CI_ConceitosBasicos.html#dados-truncados",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.4 Dados Truncados",
    "text": "1.4 Dados Truncados\nTruncamento é uma característica de alguns estudos de sobrevivência que, muitas vezes, é confundida com censura. Ele ocorre quando certos indivíduos são excluídos do estudo devido a uma condição específica. Nesses casos, os pacientes só são incluídos no acompanhamento após passarem por um determinado evento, em vez de serem acompanhados desde o início.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#sec-ReprDados",
    "href": "CI_ConceitosBasicos.html#sec-ReprDados",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.5 Representação dos Dados de Sobrevivência",
    "text": "1.5 Representação dos Dados de Sobrevivência\nSeja uma amostra aleatória de tamanho \\(n\\), o \\(i\\)-ésimo indivíduo no estudo é representado, em geral, pelo par \\((t_{i}, \\delta_{i})\\), onde \\(t_{i}\\) é o tempo de falha ou censura, indicado pela variável binária \\(\\delta_{i}\\), definida como:\n\\[\n\\delta_{i} = \\begin{cases}\n1, & \\text{se } t_{i} \\text{ é um tempo de falha} \\\\\n0, & \\text{se } t_{i} \\text{ é um tempo de censura}.\n\\end{cases}\n\\]\nPortanto, a variável resposta em análise de sobrevivência é representada por duas colunas no conjunto de dados.\nSe o estudo também incluiu covariáveis, os dados são representados por \\((t_{i}, \\delta_{i}, \\mathbf{x}_i)\\). Caso a censura seja intervalar, a representação é \\((l_{i}, u_{i}, \\delta_{i}, \\mathbf{x}_i)\\).\n\nNota: A Seção 1.5 do livro apresenta exemplos de Dados de Sobrevivência.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#especificando-o-tempo-de-sobrevivência",
    "href": "CI_ConceitosBasicos.html#especificando-o-tempo-de-sobrevivência",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.6 Especificando o Tempo de Sobrevivência",
    "text": "1.6 Especificando o Tempo de Sobrevivência\nSeja \\(T\\), uma variável aleatória (va) que, na maioria dos casos é contínua, representa o tempo de falha, assim, \\(T &gt; 0\\). Tal variável é geralmente pela sua função risco ou pela função de taxa de falha (ou risco). Tais funções, e outras relacionadas, são usados ao decorrer do processo de análise de dados de sobrevivência. A seguir, algumas definições.\n\n1.6.1 Função de Sobrevivência\nEsta é uma das principais funções probabilísticas usadas em análise de sobrevivência. A função sobrevivência é definida como a probabilidade de uma observação não falhar até certo ponto \\(t\\), ou seja a probabilidade de uma observação sobreviver ao tempo \\(t\\). Em probabilidade, isso pode ser escrito como:\n\\[\\begin{equation}\n    S(t) = P(T &gt; t),\n\\end{equation}\\]\numa conclusão a qual podemos chegar, é que a probabilidade de uma observação não sobreviver até o tempo \\(t\\), é a acumulada até o ponto \\(t\\), logo,\n\\[\\begin{equation}\n    F(t) = 1 - S(t).\n\\end{equation}\\]\n\n\n1.6.2 Função de Taxa de Falha ou de Risco\nA probabilidade da falha ocorrer em um intervalo de tempo \\([t_{1}, t_{2})\\) pode ser expressa em termos da função de sobrevivência como: \\[S(t_{1}) - S(t_{2}).\\]\nA taxa de falha no intervalo \\([t_{1}, t_{2})\\) é definida como a probabilidade de que a falha ocorra neste intervalo, dado que não ocorreu antes de \\(t_{1}\\), dividida pelo comprimento do intervalo. Assim, a taxa de falha no intervalo \\([t_{1}, t_{2})\\) é expressa por \\[\\dfrac{S(t_{1}) - S(t_{2})}{(t_{2} - t_{1})S(t_{1})}.\\]\nDe forma geral, redefinindo o intervalo como \\([t, t + \\Delta t)\\) a expressão assume a seguinte forma:\n\\[\\begin{equation}\n    \\lambda(t) = \\dfrac{S(t) - S(t + \\Delta_{t})}{\\Delta t \\text{ } S(t)}\n\\end{equation}\\]\nAssumindo \\(\\Delta t\\) bem pequeno, \\(\\lambda(t)\\) representa a taxa de falha instantânea no tempo \\(t\\) condicional à sobrevivência até o tempo \\(t\\). Observe que as taxas de falha são números positivos, mas sem limite superior. A função de taxa de falha \\(\\lambda(t)\\) é bastante útil para descrever a distribuição do tempo de vida de pacientes. Ela descreve a forma em que a taxa instantânea de falha muda com o tempo. A função de taxa de falha de \\(T\\) é, então, definida como:\n\\[\\begin{equation}\n    \\lambda(t) = \\lim_{\\Delta t \\to 0} \\dfrac{P(t \\leq T \\leq t + \\Delta t | T \\geq t)}{\\Delta t}\n\\end{equation}\\]\nA Figura 1.3, do livro, mostra três funções de taxa de falha. A função crescente indica que a taxa de falha do paciente aumenta com o transcorrer do tempo. Este comportamento mostra um efeito gradual de envelhecimento. A função constante indica que a taxa de falha não se altera com o passar do tempo. A função decrescente mostra que a taxa de falha diminui à medida que o tempo passa.\nSabe-se, ainda, que a taxa de falha para o tempo de vida de seres humanos é uma combinação das curvas apresentadas na Figura 1.3 em diferentes períodos de tempo. Ela é conhecida como curva da banheira e tem uma taxa de falha decrescente no período inicial, representando a mortalidade infantil, constante na faixa intermediária e crescente na porção final. Uma representação desta curva é mostrada na Figura 1.4, do livro.\nA função de taxa de falha é mais informativa do que a função de sobrevivência. Diferentes funções de sobrevivência podem ter formas semelhantes, enquanto as respectivas funções de taxa de falha podem diferir drasticamente. Desta forma, a modelagem da função de taxa de falha é um importante método para dados de sobrevivência.\n\n\n1.6.3 Função de Taxa de Falha Acumulada\nOutra função útil em análise de dados de sobrevivência é a função taxa de falha acumulada. Esta função, como o próprio nome sugere, fornece a taxa de falha acumulada do indivíduo e é definida por:\n\\[\\begin{equation}\n    \\Lambda(t) = \\int_{0}^{t} \\lambda(u) du.\n\\end{equation}\\]\nA função de taxa de falha acumulada, \\(\\Lambda(t)\\), não têm uma interpretação direta, mas pode ser útil na avaliação da função de maior interesse que é a função de taxa de falha, \\(\\lambda(t)\\). Isto acontece essencialmente na estimação não-paramétrica em que \\(\\Lambda(t)\\) apresenta um estimador com propriedades ótimas e \\(\\lambda(t)\\) é difícil de ser estimada.\n\n\n1.6.4 Tempo Médio e Vida Média Residual\nOutras duas quantidades de interesse em análise de sobrevivência são: o tempo médio de via e a vida média residual. A primeira é obtida pela área sob a função de sobrevivência. Isto é,\n\\[\\begin{equation}\n    t_{m} = \\int_{0}^{\\infty} S(t) dt.\n\\end{equation}\\]\nJá a vida média residual é definida condicional a um certo tempo de vida \\(t\\). Ou seja, para indivíduos com idade \\(t\\) está quantidade mede o tempo médio restante de vida e é, então, a área sob a curva de sobrevivência à direita do tempo \\(t\\) dividida por \\(S(t)\\). Isto é,\n\\[\\begin{equation}\n    \\text{vmr}(t) = \\dfrac{\\int_{0}^{\\infty} (u - t) f(u) du}{S(t)} = \\dfrac{\\int_{0}^{\\infty} S(u) du}{S(t)},\n\\end{equation}\\]\nsendo \\(f(\\cdot)\\) a função densidade de \\(T\\). Observe que \\(\\text{vmr}(0) = t_{m}\\).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CI_ConceitosBasicos.html#relações-entre-as-funções",
    "href": "CI_ConceitosBasicos.html#relações-entre-as-funções",
    "title": "1  Conceitos Básicos e Exemplos",
    "section": "1.7 Relações entre as Funções",
    "text": "1.7 Relações entre as Funções\nPara \\(T\\) uma variável aleatória contínua e não-negativa, tem-se, em termos das funções definidas anteriormente, algumas relações matemáticas importantes entre elas, a saber: \\[\\lambda(t) = \\dfrac{f(t)}{S(t)} = - \\dfrac{d}{dt} \\left[ \\log S(t) \\right],\\]\n\\[\\Lambda(t) = \\int_0^{t} \\lambda(u) du = - \\log S(t)\\] e \\[S(t) = \\exp \\left\\{ - \\Lambda(t) \\right\\} = \\exp \\left\\{ - \\int_0^{t} \\lambda(u) du \\right\\}\\]\nTais relações mostram que o conhecimento de uma das funções, por exemplo \\(S(t)\\), implica no conhecimento das demais, isto é, \\(F(t)\\), \\(f(t)\\), \\(\\lambda(t)\\) e \\(\\Lambda(t)\\). Outras relações envolvendo estas funções são as seguintes: \\[ S(t) = \\dfrac{\\text{vmr}(0)}{\\text{vmr}(t)} \\exp \\left\\{ - \\int_{0}^{t} \\dfrac{du}{\\text{vmr}(u)} \\right\\} \\] e \\[\\lambda(t) = \\left( \\dfrac{d \\text{ } [\\text{vmr}(t)]}{dt} + 1 \\right) / \\text{vmr}(t).\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Conceitos Básicos e Exemplos</span>"
    ]
  },
  {
    "objectID": "CII_EstimNaoParam.html",
    "href": "CII_EstimNaoParam.html",
    "title": "2  Técnicas Não Paramétricas",
    "section": "",
    "text": "2.1 Introdução\nO segundo capítulo do livro que está sendo usado como um dos livros-base, apresenta as técnicas não-paramétricas utilizadas para a análise de dados de sobrevivência. Essas técnicas são empregadas quando não se faz suposições sobre a forma específica da distribuição dos tempos de falha, sendo particularmente úteis para dados censurados.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_EstimNaoParam.html#o-estimador-de-kaplan-meier",
    "href": "CII_EstimNaoParam.html#o-estimador-de-kaplan-meier",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.2 O Estimador de Kaplan-Meier",
    "text": "2.2 O Estimador de Kaplan-Meier\nProposto em 1958 por Edward L. Kaplan e Paul Meier. É um estimador não-paramétrico utilizado para estimar a função de sobrevivência, \\(S(t)\\). Tal estimador também é chamado de de . O Estimador de Kaplan-Meier é uma adaptação a \\(S(t)\\) empiríca que, na ausência de censura nos dados, é definida como:\n\\[\\hat{S}(t) = \\dfrac{\\text{nº de observações que não falharam até o tempo } t}{\\text{nº total de observações no estudo}}.\\]\n\\(\\hat{S}(t)\\) é uma função que tem uma formato gráfico de escada com degraus nos tempos observados de falha de tamanho \\(1/n\\), onde \\(n\\) é o tamanho amostral.\nO processo utilizado até se obter a estimativa de Kaplan-Meier é um processo passo a passo, em que o próximo passo depende do anterior. De forma suscetível, para qualquer \\(t\\), \\(S(t)\\) pode ser escrito em termos de probabilidades condicionais. Suponha que existam \\(n\\) pacientes no estudo e \\(k (\\leq n)\\) falhas distintas nos tempos \\(t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{k}\\). Considerando \\(S(t)\\) uma função discreta com probabilidade maior que zero somente nos tempos de falha \\(t_{j}\\), \\(j = 1, \\cdots, k\\), tem-se que:\n\\[\nS(t_{j}) = (1 - q_{1}) (1 - q_{2}) \\cdots (1 - q_{j}),\n\\tag{2.1}\\]\nem que \\(q_{j}\\) é a probabilidade de um indivíduo morrer no intervalo \\([t_{j-1}, t{j})\\) sabendo que ele não morreu até \\(t_{j-1}\\) e considerando \\(t_{0} = 0\\). Ou seja, pode se escrever \\(q_{j}\\) como:\n\\[\nq_{j} = P(T \\in [t_{j-1}, t{j}) | T \\geq t_{j-1}),\n\\tag{2.2}\\]\npara \\(j = 1, \\cdots, k\\).\nA expressão geral do estimador de Kaplan-Meier pode ser apresentada após estas considerações preliminares, Formalmente, considere:\n\n\\(t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{k}\\), os \\(k\\) tempos distintos e ordenados de falha;\n\\(d_{j}\\) o número de falhas em \\(t_{j}\\), \\(j = 1, \\cdots, k\\);\n\\(n_{j}\\) o número de indivíduos sob risco em \\(t_{j}\\), ou seja, os indivíduos que não falharam e não foram censurados até o instante imediatamente anterior a \\(t_{j}\\).\n\nCom isso, pode-se definir o estimador de Kaplan-Meier como:\n\\[\n\\hat{S}_{KM}(t) = \\prod_{j \\text{ : } t_{j} &lt; t} \\left( \\dfrac{n_{j} - d_{j}}{n_{j}} \\right) = \\prod_{j \\text{ : } t_{j} &lt; t} \\left( 1 - \\dfrac{d_{j}}{n_{j}} \\right)\n\\tag{2.3}\\]\nDe forma intuitiva, por assim dizer, a Equação 2.3 é proveniente da Equação 2.1, sendo está, uma decomposição de \\(S(t)\\) em termos \\(q_{j}\\)’s. Assim, a Equação 2.3 é justificada se os \\(q_{j}\\)’s forem estimados por \\(d_{j}/n_{j}\\), que em palavras está expresso na Equação 2.2. No artigo original de 1958, Kaplan e Meier provam que a Equação 2.3 é um estimador de máxima verossimilhança para \\(S(t)\\). Seguindo certos passos, é possível provar que que \\(\\hat{S}_{KM}(t)\\) é um estimador de máxima verossimilhança de \\(S(t)\\). Supondo que \\(d_{j}\\) observações falham no tempo tempo \\(t_{j}\\), para \\(j = 1, \\cdots, k\\), e \\(m_{j}\\) observações são censuradas no intervalo \\([t{j}, t_{j+1})\\), nos tempos \\(t_{j1}, \\cdots, t_{jm_{j}}\\). A probabilidade de falha no tempo \\(t_{j}\\) é, então,\n\\[S(t_{j}) - S(t_{j}+),\\]\ncom \\(S(t_{j}+) = \\lim_{\\Delta t \\to 0+} S(t_{j} + \\Delta t)\\), \\(j = 1, \\cdots, k\\). Por outro lado, a contribuição para a função de verossimilhança de um tempo de sobrevivência censurado em \\(t_{jl}\\) para \\(l = 1, \\cdots, m_{j}\\), é:\n\\[P(T &gt; t_{jl}) = S(t_{jl}+).\\]\nA função de verossimilhança pode, então, ser escrita como:\n\\[L(S(\\cdot)) = \\prod_{j = 0}^{k} \\left\\{ [ S(t_{j}) - S(t_{j}+) ]^{d_{j}} \\prod_{l = 1}^{m_{j}} S(t_{jl}+) \\right\\}.\\]\nCom isso, é possível provar que \\(S(t)\\) que maximiza \\(L(S(\\cdot))\\) é exatamente a expressão dada pela Equação 2.3.\n\n2.2.1 Propriedades do Estimador de Kaplan-Meier\nComo um estimador de máxima verossimilhança, o estimador de Kaplan-Meier têm interessantes propriedades. As principais são:\n\nÉ não-viciado para grandes amostras;\nÉ fracamente consistente;\nConverge assintoticamente para um processo gaussiano.\n\nA consistência e normalidade assintótica de \\(\\hat{S}_{KM}(t)\\) foram provadas sob certas condições de regularidade, por Breslow e Crowley (1974) e Meier (1975) e, no artigo original Kaplan e Meier (1958) mostram que \\(\\hat{S}_{KM}(t)\\) é o estimador de máxima verossimilhança, como já dito.\n\n\n2.2.2 Variância do Estimador de Kaplan-Meier\nPara que se possa construir intervalos de confiança e testar hipóteses para \\(S(t)\\), se faz necessário ter conhecimento quanto variabilidade e precisão do estimador de Kaplan-Meier. Este estimador, assim como outros, está sujeito a variações que devem ser descritas em termos de estimações intervalares. A expressão assintótica do estimador de Kaplan-Meier é dada pela Equação 2.4.\n\\[\n\\hat{Var}[\\hat{S}_{KM}(t)] = [\\hat{S}_{KM}(t)]^{2} \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})}\n\\tag{2.4}\\]\nA expressão dada na Equação 2.4, é conhecida como fórmula de Greenwood e pode ser obtida a partir de propriedades do estimador de máxima verossimilhança. Os detalhes da obtenção da (Equação 2.4 estão disponíveis em Kalbfleisch e Prentice (1980, pag. 12-14).\nComo \\(\\hat{S}_{KM}(t)\\), para um \\(t\\) fixo, tem distribuição assintóticamente Normal. O intervalo de confiança com \\(100(1 - \\alpha)\\)% de confiança para \\(\\hat{S}_{KM}(t)\\) é expresso por:\n\\[\\hat{S}_{KM}(t) \\pm z_{\\alpha/2} \\sqrt{\\hat{Var}[\\hat{S}_{KM}(t)]}.\\]\nVale salientar que para valores extremos de \\(t\\), este intervalo de confiança pode apresentar limites que não condizem com a teoria de probabilidades. Para solucionar tal problema, aplica-se uma transformação em \\(S(t)\\) como, por exemplo, \\(\\hat{U}(t) = \\log{[-\\log{(\\hat{S}_{KM}(t)})]}\\). Esta transformação foi sugerida por Kalbfleisch e Prentice (1980), tendo sua variância estimada por:\n\\[\n\\hat{Var}[\\hat{U}(t)] = \\dfrac{ \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})} }{ \\left[\\sum_{j \\text{ : } t_{j} &lt; t} \\log{\\left( \\dfrac{n_{j} - d_{j}}{n_{j}} \\right)}\\right]^{2}} = \\dfrac{ \\sum_{j \\text{ : } t_{j} &lt; t} \\dfrac{d_{j}}{n_{j} (n_{j} - d_{j})} }{ \\left[ \\log{\\hat{S}_{KM}(t)} \\right]^{2} }\n\\] Veja uma aplicação do Estimador de Kaplan-Meier. Os dados dispostos no Apêndice (*) do livro de Análise de Sobrevivência Aplicado, de Enrico e Giolo.\n\n\nCódigo\n# -----------------------\n# [1] ATIVAÇÃO DE PACOTES\n# -----------------------\n\nif (!require(\"survival\")){\n  install.packages(\"survival\")\n}\n\n\nCarregando pacotes exigidos: survival\n\n\nCódigo\nif (!require(\"ggplot2\")) {\n  install.packages(\"ggplot2\")\n}\n\n\nCarregando pacotes exigidos: ggplot2\n\n\nCódigo\nlibrary(survival)\nlibrary(ggplot2)\n\n# ---------------------------------\n# [2] IMPORTAÇÃO E AJUSTE DOS DADOS\n# ---------------------------------\n\n# Caminho URL para os dados\nurl &lt;- \"https://docs.ufpr.br/~giolo/asa/dados/leucemia.txt\"\n\n# Leitura dos dados\ndados &lt;- read.table(url, header = TRUE)\n\n# -------------\n# [3] ESTIMAÇÃO\n# -------------\n\n# -------------------------------\n# [3.1] ESTIMADOR DE KAPLAN-MEIER\n# -------------------------------\nekm &lt;- survfit(Surv(tempos, cens) ~ 1, data = dados)\n\n# -----------------\n# [4] VISUALIZAÇÃO\n# -----------------\n\n# Preparando os dados para o ggplot2\nekm_data &lt;- data.frame(\n  time = ekm$time,\n  survival = ekm$surv,\n  lower = ekm$lower,\n  upper = ekm$upper\n)\n\n# Gráfico com ggplot2\nggplot(ekm_data, aes(x = time, y = survival)) +\n  geom_step(color = \"blue\", size = 1.2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.2) +\n  labs(\n    title = \"Curva de Sobrevivência Kaplan-Meier\",\n    x = \"Tempo\",\n    y = \"Probabilidade de Sobrevivência\",\n    caption = \"Fonte: Dados de leucemia\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    plot.caption = element_text(size = 10, hjust = 0.5)\n  )\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_EstimNaoParam.html#outros-estimadores-não-parâmetricos",
    "href": "CII_EstimNaoParam.html#outros-estimadores-não-parâmetricos",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.3 Outros Estimadores Não Parâmetricos",
    "text": "2.3 Outros Estimadores Não Parâmetricos\nTexto a ser preenchido…\n\n2.3.1 Estimador de Nelson-Aalen\nTexto a ser preenchido…",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CII_EstimNaoParam.html#testes-de-hipóteses-para-comparação-de-curvas-de-sobrevivência",
    "href": "CII_EstimNaoParam.html#testes-de-hipóteses-para-comparação-de-curvas-de-sobrevivência",
    "title": "2  Técnicas Não Paramétricas",
    "section": "2.4 Testes de Hipóteses para Comparação de Curvas de Sobrevivência",
    "text": "2.4 Testes de Hipóteses para Comparação de Curvas de Sobrevivência",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Técnicas Não Paramétricas</span>"
    ]
  },
  {
    "objectID": "CIII_ModelProb.html",
    "href": "CIII_ModelProb.html",
    "title": "3  Técnicas Paramétricas - Modelos Probabilísticos",
    "section": "",
    "text": "3.1 Introdução\nNo Capítulo anteriror, foi vista uma abordagem não paramétrica, onde, a estimação é feita sem se referir a uma distribuição de probabilidade específica para o tempo de sobrevivência.\nObtendo os estimadores não paramétricos diretamente do conjunto de dados. Supondo que o mecanismo gerador dessas informações opere de forma distinta em diferentes momentos no tempo. Funcionando de forma quase que independente, desta forma, conclui-se que a estimação não paramétrica têm tantos parâmetros quanto intervalos no tempo. Ao incluir covariáveis, o modelo de Kaplan-Meier não permite estimar o “efeito” das cováriaveis, mas apenas comparar e testar a igualdade entre duas curvas de sobrevivência.\nDe acordo com a distribuição de probabilidade que acredita-se descrever a variável resposta \\(Y\\), e de acordo com a função escolhida para a relação de \\(Y\\) com as covariáveis \\(x_{1}, x_{2}, \\cdots, x_{p}\\), identifica-se o modelo de regressão como: Linear, Poisson, Logísitico, entre outros. Aplica-se a ideia em análise de sobrevivência, de forma que o tempo de ocorrência até um evento de interesse é a variável resposta.\nNesse contexto, neste Capítulo é vista uma abordagem paramétrica para estimar as funções básicas de sobrevivência. Onde se assume como conhecida a distribuição de probabilidade do tempo de evento e, desta forma, os parâmetros seram estimados.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Técnicas Paramétricas - Modelos Probabilísticos</span>"
    ]
  },
  {
    "objectID": "CIII_ModelProb.html#distribuições-do-tempo-de-sobrevivência",
    "href": "CIII_ModelProb.html#distribuições-do-tempo-de-sobrevivência",
    "title": "3  Técnicas Paramétricas - Modelos Probabilísticos",
    "section": "3.2 Distribuições do Tempo de Sobrevivência",
    "text": "3.2 Distribuições do Tempo de Sobrevivência\nSeja \\(T\\) uma variável aleatória que representa “tempo de sobrevivênvia”, qual a distribuição de probabilidade poderia representa-lá?\nComo uma característica da variável aleatória \\(T\\) é contínua e não negativa, pode-se a partir dessa caracater´sitica, remover algumas distribuições da lista de possíveis distribuições de probabilidades de \\(T\\). Desta forma, a distribuição normal já não se torna adequada, pois tal distribuição permite valores negativos. Além disso, o tempo de sobrevivência contém, frequentemente, uma forte assimetria à direita.\nEntre os modelos paramétricos, utiliza-se muito a classe tempo de vida acelerado. Em tal classe, o tempo de sobrevivência \\(T\\), obdesce a seguinte relação:\n\\[\n\\ln(T) = \\mu + \\sigma W,\n\\tag{3.1}\\]\nonde \\(\\mu\\) é o parâmetro que representa a média de \\(\\ln(T)\\) e \\(\\sigma\\) sua dispersão, mas usualmente denominados, respectivamnete, parâmetros de locação e escala. \\(W\\) é uma variável aleatória que possa representar \\(\\ln(T)\\) a partir de uma distribuição de probabilidade.\n\n3.2.1 Distribuição Exponencial\nSe \\(T \\sim Exp(\\alpha)\\), a sua função densidade de probabilidade é expressa da seguinte forma:\n\\[\nf(t) = \\alpha e^{-\\alpha t}, \\ t \\geq 0 \\ \\text{e} \\ \\alpha &gt; 0.\n\\tag{3.2}\\]\nDesta forma, para obtermos, por exemplo, a função de sobrevivência basta integrarmos a função densidade de probabilidade, veja:\n\\[\\begin{align*}\n    S(t) & = P(T \\geq t) = \\int_{t}^{\\infty} \\alpha e^{-\\alpha t} \\ dt \\\\\n         & = \\alpha \\int_{t}^{\\infty} e^{-\\alpha t} \\ dt = \\alpha \\int_{t}^{\\infty} e^{u} \\ \\frac{du}{- \\alpha} \\\\\n         & = \\frac{\\alpha}{-\\alpha} \\int_{t}^{\\infty} e^{u} \\ du = - \\left[ e^{u} \\right]_{t}^{\\infty} = - \\left[ e^{- \\alpha t} \\right]_{t}^{\\infty} \\\\\n         & = - [ e^{- \\alpha \\infty} - e^{- \\alpha t}] = - [0 - e^{- \\alpha t}] = e^{- \\alpha t}.\n\\end{align*}\\]\nAssim, foramalmente, a função de sobrevivência é expressa por:\n\\[\nS(t) = e^{- \\alpha t}.\n\\tag{3.3}\\]\nNote que o parâmetro \\(\\alpha\\) é a velocidade de queda da função sobrevivência. Através das relações entre as funções em análise de sobrevivência, temos a função risco ou taxa de falha. Obtida pela razão entre a densidade de probabilidade e a função de sobrevivência:\n\\[\n\\lambda(t) = \\dfrac{f(t)}{S(t)} = \\dfrac{\\alpha e^{-\\alpha t}}{e^{-\\alpha t}} = \\alpha = \\text{constante}.\n\\tag{3.4}\\]\nSendo a função risco constante para todo tempo observado \\(t\\), o risco acumulado é função linear no tempo com uma inclinação na reta dado por \\(\\alpha\\):\n\\[\n\\Lambda = - \\ln[S(t)] = - \\ln[e^{-\\alpha t}] = - (- \\alpha t) = \\alpha t\n\\tag{3.5}\\]\nAfim de ilustrar para visualização e melhor aprendizado do autor e de quem for ler tal material foram simuladas as funções de sobrevivência, risco e risco acumulado variando o parâmetro \\(\\alpha\\).\n\n\nCódigo\nlibrary(ggplot2)\nset.seed(123)\nn &lt;- 1000\n\n\n\n\nCódigo\n# ---------------------------\n# [1] DISTRIBUIÇÃO EXPONENCIAL\n# ---------------------------\n\n# -------------\n# [1.1] FUNÇÕES\n# -------------\n# As funções de sobrevivência, risco e risco acumulado são simplificadas\nStexp &lt;- function(t, alpha) exp(-alpha * t)\nhtexp &lt;- function(alpha) rep(alpha, length(t))\nLtexp &lt;- function(t, alpha) alpha * t\n\n# ----------------------------------------\n# [1.2] SIMULAÇÃO E VARIAÇÃO DE PARÂMETROS\n# ----------------------------------------\ntempo &lt;- rexp(n, rate = 1) # Simulando dados de uma exponencial\nalphas &lt;- c(1, 1.5, 2)     # Valores de alpha a serem avaliados\n\n# Criando um Data Frame com valores das funções\ndados &lt;- do.call(rbind, lapply(alphas, function(alpha) {\n  data.frame(\n    tempo = tempo,\n    St = Stexp(tempo, alpha),\n    ht = htexp(alpha),\n    Lt = Ltexp(tempo, alpha),\n    alpha = factor(alpha)\n  )\n}))\n\n# -------------\n# [1.3] GRÁFICOS\n# -------------\n\n# Criando uma função para gerar gráficos\nplot_func &lt;- function(data, y_var, y_label, color_values, y_expression) {\n  ggplot(data, aes(x = tempo, y = !!sym(y_var), color = alpha)) +\n    geom_line(stat = \"summary\", fun = mean, size = 1) +\n    labs(x = \"Tempo\", y = y_expression, color = expression(alpha)) +\n    scale_color_manual(values = color_values,\n                       labels = lapply(alphas, function(a) bquote(alpha == .(a)))) +\n    theme_minimal()\n}\n\n\nVeja a seguir a Figura 3.1. Tal Figura mostra as curvas de sobrevivência para diferentes valores do parâmetro \\(\\alpha\\).\n\n\nCódigo\n# Função de Sobrevivência\nplot_func(dados, \"St\", \"S(t)\", c(\"red\", \"blue\", \"green\"), expression(S(t)))\n\n\n\n\n\nFigura 3.1: Função de Sobrevivência para diferentes valores de α\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.2. Tal Figura mostra a função de risco para diferentes valores do parâmetro \\(\\alpha\\).\n\n\nCódigo\n# Função de Risco\nplot_func(dados, \"ht\", expression(lambda(t)), c(\"red\", \"blue\", \"green\"), expression(lambda(t)))\n\n\n\n\n\nFigura 3.2: Função de Risco para diferentes valores de α\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.3. Tal Figura mostra a função de risco acumulado para diferentes valores do parâmetro \\(\\alpha\\).\n\n\nCódigo\n# Função de Risco Acumulado\nplot_func(dados, \"Lt\", expression(Lambda(t)), c(\"red\", \"blue\", \"green\"), expression(Lambda(t)))\n\n\n\n\n\nFigura 3.3: Função de Risco Acumulado para diferentes valores de α\n\n\n\n\n\n\n\n\n\n3.2.1.1 Algumas Considerações\nNote que quanto maior o valor de \\(\\alpha\\) (risco), mas abruptamente a função de sobrevivência \\(S(t)\\) decresce e maior é a inclinação que representa o risco acumulado.\nComo a distribuição exponencial possui um único parâmetro se torna matematicamente simples além de possuir um formato assimétrico.\nO seu uso em análise de sobrevivência tem certa analogia com a presuposição de normalidade em outras técnicas e áreas da estatísticas. Porém, seu presuposto de risco constante é uma afirmação muuito forte a se fazer a respeito do risco. Por exemplo, está sendo realizado um estudo sobre o cancêr, o tempo de evento de tal experimento é o tempo até que ocorra a morte ou cura do paciente. Para aplicar a distribuição exponecial para modelar esse problema seria necessário pensar que o tempo desde o diagnóstico da doênça não afeta o tempo de ocorrência do evento. O que é delicado de se aceitar, tendo em vista que o prórprio passar do tempo afeta a probabilidade de sobrevivência, o risco, risco acumulado, etc. Tendo em vista que, isso pode ser simplismente por causas naturais como aumento da idade ao passar do tempo (envelhecimento), por exemplo. Desta forma, está consequência da distribuição exponencial, isso é denominado de falta de memória da distribuição normal.\nQuando \\(\\alpha = 1\\), diz-se que a distribuição exponecial padrão. A média \\(\\left( E[t] \\right)\\) e variância \\(\\left( Var[T] \\right)\\) do tempo de sobrevivência, quando este seguir uma distribuição em Exponecial, são obtidas a partir da inversa do risco (\\(\\alpha\\)). Quanto maior o risco, menor o tempo médio de sobrevivência e menor variabilidade deste em torno na média.\n\\[\nE[T] = \\dfrac{1}{\\alpha}\n\\]\n\\[\nVar[T] = \\dfrac{1}{\\alpha^2}\n\\]\nAo afirmar que o tempo de sobrevivência \\(T\\) segue uma distribuição de exponencial equivale a dizer que na Equação 3.1, \\(W\\) segue uma distribuição valor extremo padrão, \\(\\sigma = 1\\). Assim para cada tempo \\(t\\), a Equação 3.1 é escrita da seguinte forma: \\(\\ln(T) = \\mu + w\\), como a \\(E[T] = \\frac{1}{\\alpha}\\) na distribuição exponencial, tem-se que: \\[\\mu = - \\ln(\\alpha).\\]\n\nEssa é uma forma de parametrização dos modelos parâmetricos utilizada no R, isto é, o parâmetro \\(\\alpha = e^{-\\mu}\\).\n\nComo a distribuição de \\(T\\) é assimétrica, se torna mais usual utilizar o tempo mediano de sobrevivência ao invés de tempo médio. Pode-se obter o tempo mediano de sobrevivência a partir de um tempo \\(t\\), tal que, \\(S(t) = 0,5\\), logo\n\\[\\begin{align*}\n    S(t) & = 0,5 \\Leftrightarrow e^{-\\alpha t} = 0,5 \\Leftrightarrow -\\alpha t = \\ln(1/2) \\\\\n    \\alpha t & = - \\ln(2^{-1}) \\Leftrightarrow \\alpha t = \\ln((2^{-1})^{-1}) \\\\\n    \\alpha t & = - \\ln(2).\n\\end{align*}\\]\nDesta forma, o tempo mediano de sobrevivência é definido como:\n\\[\nT_{mediano} = \\dfrac{\\ln(2)}{\\alpha}.\n\\]\nEm suma, o modelo exponecial se torna adequado quando o período do experimento é curto para que a supocisão de risco constante possa ser antendida.\n\n\n\n3.2.2 Distribuição Weibull\nNa maioria do casos de análise de sobrevivência na área da saúde, se torna mais lógico supor que o risco não é constante ao longo do tempo.\nAtualmente, a Distribuição Weibull é mais utilizada, pois permite a variação do risco ao longo do tempo. Será possível ver que a distribuição exponencial é um caso particular da distribuição weibull.\nSe o tempo de sobrevivência \\(T\\) segue uma distribuição Weibull, isto é, \\(T \\sim Weibull(\\alpha, \\gamma)\\), sua função densidade de probabilidade é expressa por:\n\\[\nf(t) = \\gamma \\alpha^{\\gamma} t^{\\gamma - 1} \\exp \\left\\{ -\\left( \\dfrac{t}{\\alpha} \\right)^{\\gamma} \\right\\}.\n\\tag{3.6}\\]\nA partir da Equação 3.6 é possível chegar a função de sobrevivência da distribuição Weibull sendo está função definida como:\n\\[\nS (t) = \\exp \\left\\{ -\\left( \\dfrac{t}{\\alpha} \\right)^{\\gamma} \\right\\},\n\\tag{3.7}\\]\nonde \\(t \\geq 0\\), \\(\\alpha\\) o parâmetro taxa e \\(\\gamma\\) parâmetro de forma. Ambos os parâmetros sempre positivos.\nA função de risco, \\(\\lambda(t)\\), depende do tempo de sobrevivência. Apresentando variação no tempo conforme a expressão:\n\\[\n\\lambda (t) = \\gamma \\alpha^{\\gamma} t^{\\gamma - 1}\n\\tag{3.8}\\]\ne a função de risco acumulado da distribuição Weibull é dada por:\n\\[\n\\Lambda (t) = - \\ln S (t) = -\\left( \\dfrac{t}{\\alpha} \\right)^{\\gamma}.\n\\tag{3.9}\\]\nNote que, o parâmetro \\(\\gamma\\) determina a forma função de risco da seguinte maneira:\n\n\\(\\gamma &lt; 1 \\rightarrow\\) função de risco decresce;\n\\(\\gamma &gt; 1 \\rightarrow\\) função de risco cresce;\n\\(\\gamma &gt; 1 \\rightarrow\\) a função de risco se torna constante, caindo no caso particular da distribuição exponencial.\n\nAfim de ilustrar para visualização e melhor aprendizado do autor e de quem for ler tal material foram simuladas as funções de sobrevivência, risco e risco acumulado variando o parâmetro \\(\\gamma\\).\n\n\nCódigo\nlibrary(ggplot2)\nset.seed(123)\nn &lt;- 1000\n\n\n\n\nCódigo\n# ------------------------\n# [2] DISTRIBUIÇÃO WEIBULL\n# ------------------------\n\n# -------------\n# [2.1] FUNÇÕES\n# -------------\n\n# Funções para Weibull\nStWei &lt;- function(t, alpha, gamma) exp(-(t/alpha)^gamma)\nhtWei &lt;- function(t, alpha, gamma) gamma * (alpha^gamma) * t^(gamma - 1)\nLtWei &lt;- function(t, alpha, gamma) (t/alpha)^gamma\n\n# ----------------------------------------\n# [2.2] SIMULAÇÃO E VARIAÇÃO DE PARÂMETROS\n# ----------------------------------------\n\n# Simulando dados de uma Weibull\ntempo &lt;- rweibull(n, shape = 2, scale = 1)\nalpha &lt;- 1   # Fixo para simplificar\ngammas &lt;- c(0.5, 1.0, 1.5, 2.0, 2.5, 3.0) # Valores de gamma\n\n# Criando um Data Frame com valores das funções\ndados &lt;- do.call(rbind, lapply(gammas, function(gamma) {\n  data.frame(\n    tempo = tempo,\n    St = StWei(tempo, alpha, gamma),\n    ht = htWei(tempo, alpha, gamma),\n    Lt = LtWei(tempo, alpha, gamma),\n    gamma = factor(gamma)\n  )\n}))\n\n# --------------\n# [2.3] GRÁFICOS\n# --------------\n\n# Função genérica para gráficos\nplot_func &lt;- function(data, y_var, y_label, color_values, y_expression) {\n  ggplot(data, aes(x = tempo, y = !!sym(y_var), color = gamma)) +\n    geom_line(stat = \"summary\", fun = mean, size = 1) +\n    labs(x = \"Tempo\", y = y_expression, color = expression(gamma)) +\n    scale_color_manual(values = color_values,\n                       labels = lapply(gammas, function(g) bquote(gamma == .(g)))) +\n    theme_minimal()\n}\n\n# Paleta de cores\ncolor_values &lt;- c(\"red\", \"blue\", \"green\", \"purple\", \"orange\", \"brown\")\n\n\nVeja a seguir a Figura 3.4. Tal Figura mostra as curvas de sobrevivência para diferentes valores do parâmetro \\(\\gamma\\).\n\n\nCódigo\n# Função de Sobrevivência\nplot_func(dados, \"St\", expression(S(t)), color_values, expression(S(t)))\n\n\n\n\n\nFigura 3.4: Função de Sobrevivência para diferentes valores de γ\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.5. Tal Figura mostra a função de risco para diferentes valores do parâmetro \\(\\gamma\\).\n\n\nCódigo\n# Função de Risco\nplot_func(dados, \"ht\", expression(lambda(t)), color_values, expression(lambda(t)))\n\n\n\n\n\nFigura 3.5: Função de Risco para diferentes valores de γ\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.6. Tal Figura mostra a função de risco acumulado para diferentes valores do parâmetro \\(\\gamma\\).\n\n\nCódigo\n# Função de Risco Acumulado\nplot_func(dados, \"Lt\", expression(Lambda(t)), color_values, expression(Lambda(t)))\n\n\n\n\n\nFigura 3.6: Função de Risco Acumulado para diferentes valores de γ\n\n\n\n\n\n\n\n\n\n3.2.2.1 Algumas Considerações\nÉ incluso a função gama na média e variância da distribuição Weibull, assim,\n\\[\nE[T] = \\alpha \\Gamma[1 + (1/\\gamma)]\n\\] \\[\nVar[T] = a^{2} \\left[ \\Gamma [1 + (2/\\gamma)] - \\Gamma [1 + (1/\\gamma)]^{2} \\right]\n\\]\nsendo a função gama \\(\\Gamma [k]\\), expressa por \\(\\Gamma [k] = \\int_{0}^{\\infty} x^{k -1} e^{- x} dx\\).\nAfim de se obter o tempo mediano de sobrevivência, igualamos a probabilidade de sobrevivência a 0,5. Desta forma:\n\\[\\begin{align*}\n    S(t) & = 0,5 \\Leftrightarrow e^{(-\\alpha t)^{\\gamma}} = 1/2 \\\\\n    - (\\alpha t)^{\\gamma} & = - \\ln(2^{-1}) \\Leftrightarrow \\alpha t = \\ln(2) \\\\\n    (\\alpha t)^{\\gamma} & = \\ln(2).\n\\end{align*}\\]\nLogo,\n\\[\nT_{mediano} = \\dfrac{\\ln(2)^{1/\\gamma}}{\\alpha}.\n\\]\n\n\n3.2.2.2 Distribuição do valor extremo ou de Gambel\nUm ponto que deve ser chamada atenção é a relação da distribuição Weibull com outra distribuição. Esta outra distribuição é chamada de distribuição do valor extremo ou de Gambel. Tal distribuição surge ao se tomar o logaritmo de uma variável \\(T\\) com distribuição de Weibull com \\(f(t)\\) dada por Equação 3.6, desta forma, \\(Y = \\ln(T)\\) tem distribuição do valor extremo com densidade da forma:\n\n\n\n3.2.3 Distribuição lognormal\nUma outra possibilidade para modelar o tempo de sobrevivência é a distribuição Log-normal. Dizer que \\(T \\sim Normal(\\mu, \\sigma^{2})\\) implica em dizer que \\(\\ln(T) \\sim log-Normal(\\mu, \\sigma^{2})\\) em que \\(\\mu\\) é a média do logaritmo do tempo de falha e \\(\\sigma^{2}\\) sua variância. Pode-se fazer uso desta relação para modelar o tempo de sobrevivência conforme uma distribuição normal, desde que, se aplique o logaritmo aos dados observados. A função densidade para tal distribuição é dada por:\n\\[\nf (t) = \\dfrac{1}{t \\sigma \\sqrt{2 \\pi}} \\exp \\left\\{- \\dfrac{1}{2} \\left(\\dfrac{\\ln(t) - \\mu}{\\sigma}\\right)^{2} \\right\\}\n\\tag{3.10}\\]\nAssim, quando o tempo de sobrevivência segue uma distribuição log-normal, sua função de sobrevivência e as demais não tem uma forma análitica explícita, desde modo, deve-se fazer uso das relações entre as funções para se obter a função taxa de falha e taxa de falha acumulada. Desta forma, essas funções são expressas, respectivamente, por:\n\\[\nS (t) = \\Phi \\left( \\dfrac{- \\ln(t) + \\mu}{\\sigma} \\right)\n\\tag{3.11}\\]\n\\[\n\\lambda (t) = \\dfrac{f (t)}{S (t)} \\ \\text{ e } \\ \\Lambda (t) = - \\ln S(t)\n\\]\nem que \\(\\Phi (\\cdot)\\) é a função de distribuição acumulada da normal padrão.\nAfim de ilustrar para visualização e melhor aprendizado do autor e de quem for ler tal material foram simuladas as funções de sobrevivência, risco e risco acumulado variando o parâmetro \\(\\mu\\).\n\n\nCódigo\nlibrary(ggplot2)\nlibrary(dplyr)\n\nset.seed(123)\nn &lt;- 1000\n\n\n\n\nCódigo\n# --------------------------\n# [4] DISTRIBUIÇÃO LOG-NORMAL\n# --------------------------\n\n# -------------\n# [4.1] FUNÇÕES\n# -------------\n\n# Função densidade (f)\nftLogNormal &lt;- function(t, mu, sigma) {\n  (1 / (t * sigma * sqrt(2 * pi))) * exp(-0.5 * ((log(t) - mu) / sigma)^2)\n}\n\n# Função de Sobrevivência (S)\nStLogNormal &lt;- function(t, mu, sigma) {\n  pnorm(-(log(t) - mu) / sigma, lower.tail = TRUE)\n}\n\n# Função de Risco (h)\nhtLogNormal &lt;- function(t, mu, sigma) {\n  ftLogNormal(t, mu, sigma) / StLogNormal(t, mu, sigma)\n}\n\n# Função de Risco Acumulado (Lambda)\nLtLogNormal &lt;- function(t, mu, sigma) {\n  -log(StLogNormal(t, mu, sigma))\n}\n\n# ----------------------------------------\n# [4.2] SIMULAÇÃO E VARIAÇÃO DE PARÂMETROS\n# ----------------------------------------\n\n# Simulando dados da distribuição log-normal\ntempo &lt;- rlnorm(n, meanlog = 0, sdlog = 1)\nmus &lt;- c(0, 0.5, 1) # Valores de mu\nsigma &lt;- 1         # Valor fixo de sigma\n\n# Criando um Data Frame com valores das funções\ndados &lt;- do.call(rbind, lapply(mus, function(mu) {\n  data.frame(\n    tempo = tempo,\n    ft = ftLogNormal(tempo, mu, sigma),\n    St = StLogNormal(tempo, mu, sigma),\n    ht = htLogNormal(tempo, mu, sigma),\n    Lt = LtLogNormal(tempo, mu, sigma),\n    mu = factor(mu)\n  )\n}))\n\n# -------------\n# [4.3] GRÁFICOS\n# -------------\n\n# Função genérica para gráficos\nplot_func &lt;- function(data, y_var, y_label, color_values, y_expression) {\n  ggplot(data, aes(x = tempo, y = !!sym(y_var), color = mu)) +\n    geom_line(stat = \"summary\", fun = mean, size = 1) +\n    labs(x = \"Tempo\", y = y_expression, color = expression(mu)) +\n    scale_color_manual(values = color_values,\n                       labels = lapply(mus, function(m) bquote(mu == .(m)))) +\n    theme_minimal()\n}\n\n# Paleta de cores\ncolor_values &lt;- c(\"red\", \"blue\", \"green\")\n\n\nVeja a seguir a Figura 3.7. Tal Figura mostra as curvas de sobrevivência para diferentes valores do parâmetro \\(\\mu\\).\n\n\nCódigo\n# Função de Sobrevivência\nplot_func(dados, \"St\", expression(S(t)), color_values, expression(S(t)))\n\n\n\n\n\nFigura 3.7: Função de Sobrevivência para diferentes valores de μ\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.8. Tal Figura mostra a função de risco para diferentes valores do parâmetro \\(\\mu\\).\n\n\nCódigo\n# Função de Risco\nplot_func(dados, \"ht\", expression(lambda(t)), color_values, expression(lambda(t)))\n\n\n\n\n\nFigura 3.8: Função de Risco para diferentes valores de μ\n\n\n\n\n\n\n\n\nVeja a seguir a Figura 3.9. Tal Figura mostra a função de risco acumulado para diferentes valores do parâmetro \\(\\mu\\).\n\n\nCódigo\n# Função de Risco Acumulado\nplot_func(dados, \"Lt\", expression(Lambda(t)), color_values, expression(Lambda(t)))\n\n\n\n\n\nFigura 3.9: Função de Risco Acumulado para diferentes valores de μ\n\n\n\n\n\n\n\n\n\n3.2.3.1 Algumas Considerações\nA média de \\(T\\) é dada por:\n\\[\nE[T] = \\exp \\{ \\mu + \\frac{\\sigma^2}{2} \\},\n\\]\ne a variância de \\(T\\) definida como:\n\\[\nVar[T] = \\exp \\{ 2 \\mu + \\sigma^2 \\} (\\exp \\{ \\sigma^{2} \\} - 1).\n\\]",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Técnicas Paramétricas - Modelos Probabilísticos</span>"
    ]
  },
  {
    "objectID": "CIII_ModelProb.html#estimação",
    "href": "CIII_ModelProb.html#estimação",
    "title": "3  Técnicas Paramétricas - Modelos Probabilísticos",
    "section": "3.3 Estimação",
    "text": "3.3 Estimação\nFoi mostrado alguns modelos probabilísticos. Porém, tais modelos apresentam quantidades desconhecidas denominadas de parâmetros ou parâmetro quando o modelo de probabilidade depende apenas de uma quantidade desconhecida, por exemplo, a distribuição exponencial.\n\n3.3.1 Método de Máxima Verossimilhança\nO Método de Máxima Verossimilhança se baseia na ideia de que, a partir de uma amostra aleatória, a estimativa para o parâmetro de interesse maximiza a probabilidade de tal amostra aleatória ser obtida.\nEm termos simples, o método de máxima verossimilhança condensa toda informação contida, através da função de verossimilhança, na amostra. Afim de encontrar o(s) parâmetro(s) da distribuição que melhor expliquem essa amostra é realizado o produtório da densidade (\\(f (t)\\)) para cada observação amostral \\(t_{i}\\), \\(i = 1, 2, \\cdots, n\\). Em livros de estatística básica, a seguinte definição da função verossimilhança é adotada, para um parâmetro (ou conjunto de parâmetros) \\(\\theta\\) qualquer:\n\\[\nL (\\theta) = \\prod_{i = 1}^{n} f (t_{i}, \\theta).\n\\]\nPerceba que \\(L\\) é função de \\(\\theta\\), sendo este um único parâmetro ou um conjunto de parâmetros, como na distribuição log-normal, onde \\(\\theta = (\\mu, \\sigma^{2})\\). Entretanto, nota-se que para qualquer observação não censurada, sua contribuição para \\(L (\\theta)\\) é a sua densidade, o que na análise de sobrevivência não é o suficiente, já que os dados apresentam censura, implicando no tempo de falha ser na verdade superior ao tempo de censura observado.\nDesta forma, faz-se uso da variável indicadora \\(\\delta_{i}\\), apresentada na Seção 1.5, que nos diz se o \\(i\\)-ésimo tempo é tempo de falha ou de censura. Logo, são feitos alguns ajustes na função de verossimilhança. Tais ajustes fazem com que para \\(\\delta_{i} = 1\\), o \\(i\\)-ésimo tempo é tempo de falha e a contribução para \\(L\\) é a própria função densidade de probabilidade, em contraste a isso, se \\(\\delta_{i} = 0\\), o \\(i\\)-ésimo tempo é tempo de censura e a contribuição dessa observação é a função de sobrevivência. Assim, a função de verossimilhança para um parâmetro ou um conjunto de parâmetros \\(\\theta\\) pode ser escrita como:\n\\[\nL (\\theta) = \\prod_{i = 1}^{n} \\ [f (t_{i}, \\theta)]^{\\delta_{i}} \\ [S(t_{i})]^{1 - \\delta_{i}}\n\\tag{3.12}\\]\nA partir da deriva do log da verossimilhança igualada a zero, \\[\\dfrac{\\partial \\ln L (\\theta)}{\\partial \\theta} = 0,\\] é possível encontrar um valor para \\(\\theta\\) que maximize \\(\\ln L (\\theta)\\), portanto, maximize \\(L (\\theta)\\).\n\n3.3.1.1 Aplicações\nSerá mostrado nessa seção como encontrar o estimador ou estimadores de máxima verossimilhança para os parâmetros das disitribuições citadas.\n\n3.3.1.1.1 Distribuição Exponecial\nPara uma distribuição exponencial conforme descrita na Seção 3.2.1. O Estimador de Máxima Verossimilhança do parâmetro \\(\\alpha\\) pode ser obtido de acordo com os seguintes passos:\n\nDeterminar a função verossimilhança \\(L (\\alpha)\\):\n\n\\[\\begin{align*}\n    L (\\alpha) & = \\prod_{i = 1}^{n} [\\alpha \\exp \\{-\\alpha t_{i}\\}]^{\\delta_{i}} [\\exp \\{-\\alpha t_{i}\\}]^{1 - \\delta_{i}} \\\\\n               & = \\prod_{i = 1}^{n} \\alpha^{\\delta_{i}} \\exp \\{ - \\alpha t_{i} \\}.\n\\end{align*}\\]\n\nTomar o logaritmo da função verossimilhança \\(\\ln L (\\alpha)\\):\n\n\\[\\begin{align*}\n    \\ln L (\\alpha) & = \\sum_{i = 1}^{n} \\ln \\left[ \\alpha^{\\delta_{i}} \\exp \\{ - \\alpha t_{i} \\} \\right] = \\sum_{i = 1}^{n} \\ln \\left[ \\alpha^{\\delta_{i}} \\right] + \\sum_{i = 1}^{n} \\ln \\left[ \\exp \\{ - \\alpha t_{i} \\} \\right] \\\\\n                   & = \\sum_{i = 1}^{n} \\delta_{i} \\ln \\alpha + \\sum_{i = 1}^{n} - \\alpha t_{i} =  \\ln \\alpha \\sum_{i = 1}^{n} \\delta_{i} - \\alpha \\sum_{i = 1}^{n} t_{i}. \\\\\n\\end{align*}\\]\n\nDerivar a função do log da verossimilhança \\(\\dfrac{\\partial \\ln L (\\theta)}{\\partial \\theta} = 0\\):\n\n\\[\\begin{align*}\n    \\dfrac{\\partial \\ln L (\\theta)}{\\partial \\theta}  & = \\dfrac{1}{\\alpha} \\sum_{i = 1}^{n} \\delta_{i} - \\sum_{i = 1}^{n} t_{i}.\n\\end{align*}\\]\nAo igualar a derivada a zero e isolando \\(\\alpha\\) em um dos lados da igualdade e assuminado que a forma análitica de \\(\\alpha\\) obtida é um estimador de máxima verossimilhança temos:\n\\[\\begin{align*}\n    \\dfrac{\\partial \\ln L (\\theta)}{\\partial \\theta}  & = 0 \\\\\n    \\dfrac{1}{\\hat{\\alpha}} \\sum_{i = 1}^{n} \\delta_{i} - \\sum_{i = 1}^{n} t_{i} & = 0 \\\\\n    \\hat{\\alpha} & = \\dfrac{\\sum_{i = 1}^{n} \\delta_{i}}{\\sum_{i = 1}^{n} t_{i}}\n\\end{align*}\\]\nNote que, para o caso em que não se tem censura o numerador, \\(\\sum_{i = 1}^{n} \\delta_{i}\\), equivale ao tamanho da amostra \\(n\\).\nA seguir, temos um exemplo computacional. Simulou-se uma amostra proveniente de uma distribuição exponecial e a partir de tal amostra se obteve a estimativa de máxima verossimilhança do parâmetro \\(\\alpha\\) de tal amostra.\n\n\nCódigo\nset.seed(123)\nn &lt;- 1000\n\n# -------------\n# [2.1] FUNÇÕES\n# -------------\n# Função de Sobrevivência\nStexp &lt;- function(t, alpha) exp(-alpha * t)\n\n# ----------------------------------------\n# [2.2] SIMULAÇÃO E VARIAÇÃO DE PARÂMETROS\n# ----------------------------------------\n\nalpha &lt;- 1.5 # Parâmetro de taxa (escala) populacional\ntempo &lt;- rexp(n, rate = alpha) # Simulando dados de uma exponencial\n\nemvExp &lt;- n / sum(tempo) # EMV\n\n# Criando um Data Frame com valores das funções\ndados &lt;- data.frame(\n  Tempo = tempo,\n  St = Stexp(tempo, alpha),\n  emvSt = Stexp(tempo, emvExp)\n)\n\n\nO valor de verdadeiro do parâmetro \\(\\alpha =\\) 1.5. A estimativa de máxima verossimilhança obtida foi \\(\\hat{\\alpha} =\\) 1.46.\nVeja a Tabela 3.1 que mostra as dez primeiras observações e suas respectivas funções de sobrevivência, sobrevivência real e sobrevivência estimada.\n\n\nCódigo\nlibrary(knitr)\n\nknitr::kable(head(dados), \n             col.names = c(\"Tempo\", \"S(t)\", \"S(t) EMV\"),\n             escape = FALSE,\n             align = 'c',\n             booktabs = TRUE)\n\n\n\n\nTabela 3.1: Real e Estimado para as Funções de Sobrevivência\n\n\n\n\n\n\nTempo\nS(t)\nS(t) EMV\n\n\n\n\n0.5623048\n0.4302206\n0.4409133\n\n\n0.3844068\n0.5617995\n0.5713079\n\n\n0.8860366\n0.2647273\n0.2751688\n\n\n0.0210516\n0.9689160\n0.9698070\n\n\n0.0374740\n0.9453397\n0.9468876\n\n\n0.2110008\n0.7286941\n0.7354381\n\n\n\n\n\n\n\n\nTemos também a comparação dessas duas curvas de sobrevivência, ilustradas na Figura 3.10.\n\n\nCódigo\nggplot(dados, aes(x = Tempo)) +\n  geom_line(aes(y = St, color = \"alpha\"), lwd = 1.5) +\n  geom_line(aes(y = emvSt, color = \"emvAlpha\"), lwd = 1, lty = 4) +\n  scale_color_manual(\n    values = c(\"alpha\" = \"black\", \"emvAlpha\" = \"red\"),\n    labels = c(expression(alpha), expression(hat(alpha)))) +\n  labs(\n    x = \"Tempo\",\n    y = expression(S(t)), \n    color = \"Parâmetro\") + \n  theme_minimal()\n\n\n\n\n\nFigura 3.10: Comparação do verdadeiro valor do parâmetro α com sua estimativa de máxima verossimilhança.\n\n\n\n\n\n\n\n\n\n\n3.3.1.1.2 Distribuição Weibull\nPara uma distribuição Weibull, descrita na Seção 3.2.2 não há uma forma análitica para \\(\\gamma\\) e \\(\\alpha\\). Logo, para obter a sua estimativa de máxima verossimilhança se usa um método de aproximação numérica, será introduzido aqui o Método Iterativo de Newton-Raphson.\nO Método de Newton-Raphson é uma abordagem iterativa eficiente para resolver equações não lineares, sendo amplamente utilizado na estimação de parâmetros de distribuições estatísticas. Quando aplicado ao ajuste de distribuições, como a Weibull no contexto de análise de sobrevivência, o método busca maximizar a função de verossimilhança, resolvendo o sistema de equações derivado das condições de otimalidade (gradiente nulo).\nA fórmula iterativa é:\n\\[\n\\theta_{n+1} = \\theta_n - \\mathbf{H}^{-1}(\\theta_n) \\nabla L(\\theta_n),\n\\]\nonde:\n\n\\(\\theta_{n}\\) é o vetor de parâmetros estimados na iteração \\(n\\);\n\\(L(\\theta)\\) é a função log-verossimilhança;\n\\(\\nabla L(\\theta)\\) é o vetor gradiente (derivadas parciais de \\(L(\\theta)\\));\n\\(\\mathbf{H}(\\theta)\\) é a matriz Hessiana (segunda derivada de \\(L(\\theta)\\)).\n\nVantagens no ajuste de distribuições:\n\nEficiência: O método converge rapidamente quando o ponto inicial \\(\\theta_{0}\\) está próximo dos valores reais dos parâmetros.\nFlexibilidade: Adequa-se a diferentes modelos, como a distribuição Weibull, usada para modelar tempos de vida ou sobrevivência.\n\nCuidados na aplicação:\n\nConvergência: Garantida apenas se o ponto inicial estiver próximo da solução e as condições de regularidade forem atendidas.\nCálculo da Hessiana: Pode ser computacionalmente intensivo para distribuições complexas.\n\nNo caso da distribuição Weibull, a aplicação do método Newton-Raphson envolve derivadas em relação aos parâmetros de forma (\\(\\gamma\\)) e escala (\\(\\alpha\\)), permitindo ajustar o modelo aos dados observados de tempos de sobrevivência de forma precisa e eficiente.\nPara utilizar o Método Iterativo de Newton-Raphson, pode-se escrever o algoritmo passo a passo. Outra forma, é usar a função do R optim. Será aprensatado as duas formas e seus detalhes serão comentados.\nComeçando pela construção do algoritmo passo a passo, precisamos definir algumas funções. A primeira é a função de verossimilhança da distribuição Weibull, que pode ser obtida a partir da Equação 3.12 ao substituir respectivamente a função densidade e sobrevivência da distribuição Weibull respectivamente. Assim:\n\\[\\begin{align*}\n    L (\\gamma, \\alpha) & = \\prod_{i = 1}^{n} \\left[ \\gamma \\alpha^{\\gamma} t_{i}^{\\gamma - 1} \\exp \\left\\{ - \\left(\\dfrac{t_{i}}{\\alpha}\\right)^{\\gamma} \\right\\} \\right]^{\\delta_{i}} \\left[ \\exp \\left\\{ - \\left(\\dfrac{t_{i}}{\\alpha}\\right)^{\\gamma} \\right\\} \\right]^{1 - \\delta_{i}} \\\\\n    & = \\prod_{i = 1}^{n} \\left[ \\dfrac{\\gamma}{\\alpha^{\\gamma}} t^{\\gamma - 1} \\right]^{\\delta_{i}}  \\exp \\left\\{ - \\left(\\dfrac{t_{i}}{\\alpha}\\right)^{\\gamma} \\right\\}\n\\end{align*}\\]\nToma-se o logaritmo de \\(L (\\gamma, \\alpha)\\), logo:\n\\[\\begin{align*}\n    \\ln L (\\gamma, \\alpha) & = \\sum_{i = 1}^{n} \\delta_{i} \\ln\\{ \\gamma \\} - \\sum_{i = 1}^{n} \\delta_{i} \\gamma \\ln\\{ \\alpha \\} + \\sum_{i = 1}^{n} \\delta_{i} (\\gamma - 1) \\ln \\{ t_{i} \\} + \\sum_{i = 1}^{n} - (\\alpha^{-1} t_{i})^{\\gamma} \\\\\n    & = \\ln\\{ \\gamma \\} \\sum_{i = 1}^{n} \\delta_{i} - \\gamma \\ln\\{ \\alpha \\} \\sum_{i = 1}^{n} \\delta_{i} + (\\gamma - 1) \\sum_{i = 1}^{n} \\delta_{i} \\ln \\{ t_{i} \\} + \\sum_{i = 1}^{n} - (\\alpha^{-1} t_{i})^{\\gamma}\n\\end{align*}\\]\nAgora, aplica-se as derivadas de primeira ordem em relação a \\(\\gamma\\) e \\(\\alpha\\).\n\\[\n\\dfrac{\\partial \\ln L (\\gamma, \\alpha)}{\\partial \\gamma} = \\dfrac{\\sum_{i = 1}^{n} \\delta_{i}}{\\gamma} - \\ln\\{\\alpha\\} \\sum_{i = 1}^{n} \\delta_{i} + \\sum_{i = 1}^{n} \\delta_{i} \\ln\\{t_{i}\\} - \\sum_{i = 1}^{n} (\\alpha^{-1} t_{i})^{\\gamma} \\ln\\{ (\\alpha^{-1} t_{i})^{\\gamma} \\}\n\\]\n\\[\n\\dfrac{\\partial \\ln L (\\gamma, \\alpha)}{\\partial \\alpha} = - \\dfrac{\\gamma \\sum_{i = 1}^{n} \\delta_{i}}{\\alpha} + \\gamma \\alpha^{- \\gamma - 1}\\sum_{i = 1}^{n} t_{i}^{\\gamma}\n\\]\nToma-se agora as derivadas de segunda ordem.\n\\[\n\\dfrac{\\partial^{2} \\ln L (\\gamma, \\alpha)}{\\partial \\gamma^{2}} = \\dfrac{\\sum_{i = 1}^{n} \\delta_{i}}{\\gamma^{2}} - \\sum_{i = 1}^{n} (\\alpha^{-1} t_{i})^{\\gamma} [ \\ln\\{ (\\alpha^{-1} t_{i})^{\\gamma} \\} ]^2\n\\]\n\\[\n\\dfrac{\\partial^{2} \\ln L (\\gamma, \\alpha)}{\\partial \\alpha^{2}} = \\dfrac{\\gamma \\sum_{i = 1}^{n} \\delta_{i}}{\\alpha^{2}} - \\gamma (\\gamma + 1) \\alpha^{- \\gamma - 2} \\sum_{i = 1}^{n} t_{i}^{\\gamma}\n\\]\n\\[\n\\dfrac{\\partial^{2} \\ln L (\\gamma, \\alpha)}{\\partial \\gamma \\partial \\alpha} = - \\dfrac{\\sum_{i = 1}^{n} \\delta_{i}}{\\alpha} + \\sum_{i = 1}^{n} \\dfrac{t_{i}^{\\gamma}}{\\alpha^{\\gamma + 1}} \\left( \\gamma \\ln \\left\\{ \\dfrac{t_{i}}{\\alpha} \\right\\} + 1 \\right)\n\\]\nCom todas as derivadas definidas, é possível definirmos algumas funções e variáveis que iremos precisar para utilizar o algoritmo de Newton-Raphson.\n\n\nCódigo\ncat(\"Era para ser um bloco de código. Porém, tal código está em manutenção\")\n\n\nEra para ser um bloco de código. Porém, tal código está em manutenção\n\n\nO bloco de código abaixo contém o algoritmo de Newton-Raphson.\n\n\nCódigo\ncat(\"Era para ser um bloco de código. Porém, tal código está em manutenção\")\n\n\nEra para ser um bloco de código. Porém, tal código está em manutenção\n\n\nO bloco abaixo mostra o uso da função optim para otimização.\n\n\nCódigo\n# ----------\n# Otimização\n# ----------\n\n# Semente\nset.seed(123)\n\n# ---------------------------------\n# Simulação e Visualização do Dados\n# ---------------------------------\n# Tamanho da amostra\nn &lt;- 1000\n\n# Parâmetros da distribuição\nwShape &lt;- 2\nwScale &lt;- 1.5\n\n# Simulação\ndadosWeibull &lt;- rweibull(n, shape = wShape, scale = wScale)\n\n# --------------------------\n# Função Log-verossimilhança\n# --------------------------\n\nlogWeibull &lt;- function(theta, dados){\n  gamma &lt;- theta[1] # Parâmetro de forma\n  alpha &lt;- theta[2] # Parâmetro de escala\n  n &lt;- length(dados)\n  t &lt;- dados\n\nlogverossimil &lt;- (n * log(gamma)) - (gamma * log(alpha) * n) + (gamma - 1) * sum(log(t)) - sum((t/alpha)^gamma)\nreturn(-logverossimil)\n}\n\n# ------------------------\n# Aplicando a função optim\n# ------------------------\n\ntheta0 &lt;- c(1.5, 1) # Chute inicial\nestimate &lt;- optim(par = theta0, fn = logWeibull, gr = NULL , method = \"BFGS\" ,\n             hessian = TRUE, dados=dadosWeibull)\nestimate\n\n\n$par\n[1] 2.015515 1.507207\n\n$value\n[1] 999.1172\n\n$counts\nfunction gradient \n      52        9 \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n$hessian\n          [,1]     [,2]\n[1,]  451.7492 -281.952\n[2,] -281.9520 1788.248\n\n\nAssim como na distribuição exponencial, será feita uma comparação entre o real e estimado.\n\n\nCódigo\n# ---------------------\n# AJUSTES DE FORMATAÇÃO\n# ---------------------\n\n# Função de Sobrevivência\nStWeibull &lt;- function(t, gamma, alpha) exp(-(t/alpha)^gamma)\n\n# Data Frame\ndfWeibull &lt;- data.frame(\n  Tempo = dadosWeibull,\n  St = StWeibull(dadosWeibull, wShape, wScale),\n  EMVSt = StWeibull(dadosWeibull, estimate$par[1], estimate$par[2])\n)\n\n\nVeja a Tabela 3.2 que mostra as dez primeiras observações e suas respectivas funções de sobrevivência, sobrevivência real e sobrevivência estimada.\n\n\nCódigo\nlibrary(knitr)\n\nknitr::kable(head(dfWeibull), \n             col.names = c(\"Tempo\", \"S(t)\", \"S(t) EMV\"),\n             escape = FALSE,\n             align = 'c',\n             booktabs = TRUE)\n\n\n\n\nTabela 3.2: Real e Estimado para as Funções de Sobrevivência da Distribuição Weibull\n\n\n\n\n\n\nTempo\nS(t)\nS(t) EMV\n\n\n\n\n1.6745421\n0.2875775\n0.2904304\n\n\n0.7315788\n0.7883051\n0.7921747\n\n\n1.4183502\n0.4089769\n0.4128247\n\n\n0.5290778\n0.8830174\n0.8858229\n\n\n0.3716200\n0.9404673\n0.9422483\n\n\n2.6362482\n0.0455565\n0.0456849\n\n\n\n\n\n\n\n\nTemos também a comparação dessas duas curvas de sobrevivência, ilustradas na Figura 3.11.\n\n\nCódigo\nlibrary(ggplot2)\n\nggplot(dfWeibull, aes(x = Tempo)) +\n  geom_line(aes(y = St, color = \"Verdadeiro\"), lwd = 2) +\n  geom_line(aes(y = EMVSt, color = \"EMV\"), lwd = 1, lty = 4) +\n  scale_color_manual(\n    values = c(\"Verdadeiro\" = \"black\", \"EMV\" = \"red\"),\n    labels = c(\n      \"Verdadeiro\" = expression(paste(\"Verdadeiro: \", gamma, \", \", alpha)),\n      \"EMV\" = expression(paste(\"EMV: \", hat(gamma), \", \", hat(alpha)))\n    )) +\n  labs(\n    x = \"Tempo\",\n    y = expression(S(t)), \n    color = \"Parâmetros\") + \n  theme_minimal()\n\n\n\n\n\nFigura 3.11: Comparação do verdadeiro valor dos parâmetros γ e α com suas estimativas de máxima verossimilhança.\n\n\n\n\n\n\n\n\n\n\n3.3.1.1.3 Distribuição Log-Normal\n\n\n\n3.3.1.2 Aplicações com Censura\nPodemos utilizar os conhecimentos até aqui obtidos para modelar e estimar parâmetros, e consequentemente, curvas de sobrevivência onde exista censura. Vejamos os blocos de códigos a seguir.\n\nAtivamos os pacotes necessários:\n\n\n\nCódigo\n# -----------------------\n# [1] Ativação de Pacotes\n# -----------------------\n\nlibrary(survival)\nlibrary(ggplot2)\n\n\n\nSimulamos os dados com censura:\n\n\n\nCódigo\n# -----------------------\n# [2] Simulação dos Dados\n# -----------------------\n\n# Definindo Semente\nset.seed(123)\n\n# Parâmetros\nn &lt;- 1000       # Número total de observações\ngamma &lt;- 2      # Parâmetro shape da Weibull\nalpha &lt;- 1.5    # Parâmetro scale da Weibull\nTaxaExp &lt;- 1    # Taxa da distribuição exponencial\npropCens &lt;- 1/3 # Proporção desejada de censuras\n\n# Vetores para armazenar os resultados\nTobservado &lt;- numeric(n)\nindCensura &lt;- numeric(n)\n\n# Contadores\nnFalhas &lt;- 0\nnCensuras &lt;- 0\n\n# Loop para gerar os tempos\nfor (i in 1:n) {\n  # Gerar um tempo de falha e um tempo de censura\n  Tfalha &lt;- rweibull(1, shape = gamma, scale = alpha)\n  Tcensu &lt;- rexp(1, rate = TaxaExp)\n  \n  # Verificar qual é o menor tempo\n  if (Tfalha &lt;= Tcensu) {\n    Tobservado[i] &lt;- Tfalha\n    indCensura[i] &lt;- 1 # Falha\n    nFalhas &lt;- nFalhas + 1\n  } else {\n    if (nCensuras &lt; propCens * n) {\n      Tobservado[i] &lt;- Tcensu\n      indCensura[i] &lt;- 0 # Censura\n      nCensuras &lt;- nCensuras + 1\n    } else {\n      Tobservado[i] &lt;- Tfalha\n      indCensura[i] &lt;- 1 # Falha\n      nFalhas &lt;- nFalhas + 1\n    }\n  }\n}\n\n# Verificar as proporções\ncat(\"Proporção de falhas:\", nFalhas / n, \"\\n\")\n\n\nProporção de falhas: 0.666 \n\n\nCódigo\ncat(\"Proporção de censuras:\", nCensuras / n, \"\\n\")\n\n\nProporção de censuras: 0.334 \n\n\nCódigo\n# Dados simulados\ndados &lt;- data.frame(Tempo = Tobservado, Censura = indCensura)\n\n# Histograma\nggplot(data = dados, aes(x = Tempo)) +\n  geom_histogram(bins = 15, fill = \"blue\") +\n  labs(title = \"Histograma do Tempo de Sobrevivência - Simulação\",\n       x = \"Tempo\", y = \"Frequência\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\nEstimação Não Paramétrica.\n\n\n\nCódigo\n# -------------\n# [3] Estimação\n# -------------\n\n# -------------------------------\n# [3.1] Estimação Não Paramátrica\n# -------------------------------\n# ---------------------------------\n# [3.1.1] Estimador de Kaplan-Meier\n# ---------------------------------\n\n# Modelo de Kaplan-Meier\nekm &lt;- survfit(Surv(Tempo, Censura) ~ 1, data = dados)\n\n# Formatando como DataFrame\nDataEKM &lt;- data.frame(Time = ekm$time, Survival = ekm$surv, Type = \"Kaplan-Meier\")\n\n# Visualização da curva\nggplot(data = DataEKM, aes(x = Time, y = Survival)) +\n  geom_line(color = \"blue\", lwd = 1.5) +\n  labs(title = \"S(t) - Kaplan-Meier\",\n       x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\nEstimação Não Paramétrica - Distribuição Exponencial.\n\n\n\nCódigo\n# ---------------------------\n# [3.2] Estimação Paramátrica\n# ---------------------------\n# --------------------------------\n# [3.2.1] Distribuição Exponencial\n# --------------------------------\n\n# Função de Sobrevivência\nStexp &lt;- function(t, alpha) exp(-alpha * t)\n\n# EMV de α\nemvExp &lt;- sum(dados$Censura) / sum(dados$Tempo)\n\n# EMV da Sobrevivência\nEMVSurvExp &lt;- Stexp(dados$Tempo, emvExp)\n\n# Formatando como DataFrame\nDataExp &lt;- data.frame(Time = dados$Tempo, Survival = EMVSurvExp, Type = \"Exponencial\")\n\n# Visualização da curva\nggplot(data = DataExp, aes(x = Time, y = Survival)) +\n  geom_line(color = \"red\", lwd = 1.5) +\n  labs(title = \"S(t) - Exponencial\",\n       x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n\n\n\n\n\n\n\n\n\n\nEstimação Não Paramétrica - Distribuição Weibull.\n\n::: {.cell}\n\nCódigo\n# ----------------------------\n# [3.2.1] Distribuição Weibull\n# ----------------------------\n\n# Função de Sobrevivência\nStWeibull &lt;- function(t, gamma, alpha) exp(-(t / alpha)^gamma)\n\n# EMV de γ e α\n# 1. Função Log-verossimilhança\nlogWeibull &lt;- function(theta, dados){\n  gamma &lt;- theta[1] # Parâmetro de forma\n  alpha &lt;- theta[2] # Parâmetro de escala\n\n  t &lt;- dados$Tempo   # Tempo de falha\n  c &lt;- dados$Censura # Variável indicadora\n\n  logv &lt;- (sum(c) * log(gamma)) - (gamma * log(alpha) * sum(c)) +\n(gamma - 1) * sum(c * log(t)) - sum((t / alpha)^gamma)\n  return(-logv)\n}\n\n# 2. Otimizando\nTheta0 &lt;- c(1.5, 1)\nestimate &lt;- optim(par = Theta0, fn = logWeibull,\n              gr = NULL, method = \"BFGS\", hessian = TRUE, dados = dados)\n\n::: {.cell-output .cell-output-stderr}\nWarning in log(gamma): NaNs produzidos\nWarning in log(gamma): NaNs produzidos\nWarning in log(gamma): NaNs produzidos\n:::\n::: {.cell-output .cell-output-stderr}\nWarning in log(alpha): NaNs produzidos\nWarning in log(alpha): NaNs produzidos\nWarning in log(alpha): NaNs produzidos\nWarning in log(alpha): NaNs produzidos\nWarning in log(alpha): NaNs produzidos\nWarning in log(alpha): NaNs produzidos\n:::\n\nCódigo\nestimate\n\n::: {.cell-output .cell-output-stdout}\n$par\n[1] 2.013314 1.535915\n\n$value\n[1] 745.9756\n\n$counts\nfunction gradient \n      31        9 \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n$hessian\n          [,1]       [,2]\n[1,] 304.76432  -96.91392\n[2,] -96.91392 1144.24624\n:::\n\nCódigo\n# EMV da Sobrevivência\nEMVSurvWeib &lt;- StWeibull(dados$Tempo, estimate$par[1], estimate$par[2])\n\n# Formatando como DataFrame\nDataWeib &lt;- data.frame(Time = dados$Tempo, Survival = EMVSurvWeib, Type = \"Weibull\")\n\n# Visualização da curva\nggplot(data = DataWeib, aes(x = Time, y = Survival)) +\n  geom_line(color = \"green\", lwd = 1.5) +\n  labs(title = \"S(t) - Weibull\",\n   x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))\n\n::: {.cell-output-display}  ::: :::\n\nPor fim, com o objetivo de fazer uma comparação, visual, temos a Figura abaixo.\n\n\nCódigo\n# --------------------\n# [4] Análise Conjunta\n# --------------------\n\n# Unindo os dados para visualização\nAllData &lt;- rbind(DataEKM, DataExp, DataWeib)\n\n# Gráfico com ggplot2\nggplot(AllData, aes(x = Time, y = Survival)) +\n  geom_line(aes(color = Type, linetype = Type), lwd = 1.5) +\n  labs(title = \"S(t): Kaplan-Meier, Weibull e Exponencial\",\n       x = \"Tempo\", y = \"Probabilidade de Sobrevivência\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(hjust = 0.5, face = \"bold\"),\n        legend.title = element_blank()) +\n  scale_color_manual(values = c(\"blue\", \"green\", \"red\")) +\n  scale_linetype_manual(values = c(1, 2, 3)) # c(\"solid\", \"dashed\", \"dotted\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Técnicas Paramétricas - Modelos Probabilísticos</span>"
    ]
  }
]